var TcHmi;!function(e){!function(t){!function(n){function o(n,o,a){const r=o.AllParams.find(e=>e.InstanceName==a);let i;e.EventProvider.register(n.getId()+".onDestroyed",e=>{e.destroy(),null!=i&&i()}),null!=r&&(n instanceof t.Controls.Common.Textblock?r.watch(e=>{n.setText(e)}):n instanceof t.Controls.Common.InputBox?r.DataType==t.DataType.number?(r.watch(e=>{n.setValue(e)}),t.BA.BaVariable.isIBaDecoratingParameterInfo(r.Info)?r.getDecoratingInfo().then(e=>{null!=e&&"number"==typeof e&&n.setUnit(e)}).catch(e=>console.warn(e)):t.BA.BaVariable.isIBaDecoratedParameterInfo(r.Info)&&n.setUnit(r.Info.Decorated),i=n.eventHandler.register(t.Components.InputBox.InputBoxEvents.onUserInteractionFinished,()=>{r.write(n.getValue(),e=>{t.Server.checkServerResult(t.Logger.Severity.warn,e)})})):console.error("Not implemented DataType of BaVariable",r):n instanceof t.Controls.Common.Checkbox?r.DataType==t.DataType.boolean?(r.watch(e=>{n.setState(e)}),t.BA.BaVariable.isIBaEnumeratingParameterInfo(r.Info)?n.baObjectHandler.watchValueRange(r,e=>{null!=e&&(n.setActiveText(e.get(1)),n.setInactiveText(e.get(0)))}):t.BA.BaVariable.isIBaEnumeratedParameterInfo(r.Info)&&(n.setActiveText(r.Info.Enumerated[1]),n.setInactiveText(r.Info.Enumerated[2])),i=n.eventHandler.register(t.Components.Checkbox.CheckboxEvents.onUserInteractionFinished,()=>{r.write(n.getState(),e=>{t.Server.checkServerResult(t.Logger.Severity.warn,e)})})):console.error("Not implemented DataType of BaVariable",r):n instanceof t.Controls.Common.Combobox?r.DataType==t.DataType.enum?(r.watch(e=>{n.setSelectedValue(e)}),t.BA.BaVariable.isIBaEnumeratingParameterInfo(r.Info)?n.baObjectHandler.watchValueRange(r,e=>{null!=e?n.setData(t.Components.Combobox.toComboboxItemArray(e)):console.warn(`Could not set state texts of ${n.getId()}!`)}):t.BA.BaVariable.isIBaEnumeratedParameterInfo(r.Info)&&n.setData(t.Components.Combobox.toComboboxItemArray(r.Info.Enumerated)),i=n.eventHandler.register(t.Components.Combobox.ComboboxEvents.onUserInteractionFinished,()=>{r.write(n.getSelectedValue(),e=>{t.Server.checkServerResult(t.Logger.Severity.warn,e)})})):console.error("Not implemented handling of BaVariable!",r):console.error(`No BaVariable with name '${a}' in BaObject!`,o))}function a(n,o){if("function"!=typeof n.setBaObject)throw new Error("Nested TcHmiUserControl does not have a property BaObject!");t.BaObjectHandler.isIUsesBaObject(n)?n.baObjectHandler.setBaObject(o):n.setBaObject(new e.Symbol(o.getSymbolExpression().toString()))}n.UseBaObjectsInUserControl=function(n,r){if(!(r instanceof e.Symbol))return;if(!(n.getParent()instanceof e.Controls.System.TcHmiUserControlHost))throw new Error("Parent of TcHmiUserControl must be TcHmiUserControlHost!");const i=function t(n){let o=[];const a=n.getChildren();for(let n=0;n<a.length;n++){const r=a[n];r instanceof e.Controls.System.TcHmiContainerControl?o=o.concat(t(r)):o.push(r)}return o}(n);t.BaObjectHandler.readBaObject(r.getExpression().getName(),!0,!0).then(r=>{for(let l=0;l<i.length;l++){const m=i[l];if(t.BaObjectHandler.isIUsesBaObject(m)||m instanceof e.Controls.System.TcHmiUserControlHost){if(-1==m.getId().indexOf(n.getId()+"."))continue;let e=m.getId().replace(n.getId()+".","");const i=e.split(".");if("Root"==e||e.indexOf("Root.")>-1)if(e.indexOf(".")>-1){if(i.length>2){console.error('Only access a variable under the root element. E.g. "Root.sDescription".');continue}o(m,r,i[1])}else a(m,r);else if(e.indexOf(".")>-1){if(r instanceof t.BA.BaView){var s,c=r;do{if(e=i.shift(),s=void 0,c instanceof t.BA.BaView&&(s=c.Children.get(e)),null==s){if(0!=i.length){console.error("At this point you need to point to a BaVariable!");break}o(m,c,e)}else c=s,0==i.length&&a(m,c)}while(i.length>0)}else if(i.length>2)throw new Error("Bound BaObject is not a BaView and therefore a children BaObject can not be accessed")}else if(r instanceof t.BA.BaView){const t=r.Children.get(e);t&&a(m,t)}}}})}}(t.Functions||(t.Functions={}))}(e.BuildingAutomation||(e.BuildingAutomation={}))}(TcHmi||(TcHmi={})),TcHmi.Functions.registerFunctionEx("UseBaObjectsInUserControl","TcHmi.BuildingAutomation.Functions",TcHmi.BuildingAutomation.Functions.UseBaObjectsInUserControl);