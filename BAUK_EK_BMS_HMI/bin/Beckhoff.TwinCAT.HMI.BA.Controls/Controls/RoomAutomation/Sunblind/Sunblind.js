var TcHmi;!function(e){!function(t){var n;(function(a){let i;!function(e){e.first="first",e.second="second"}(i||(i={}));class o extends n.System.BaseRoomControl{constructor(e,t,n){super(e,t,n),this.__defaultBaTemplateDescription=o.BaTemplateDescription,this.__positionStep=5,this.__angleMode=!1,this.__positionFeedbackReady=[],this.__angleFeedbackReady=[],this.__useCurrentPosition=!1,this.__useCurrentAngle=!1}__previnit(){null==this.__baFc&&(this.__baFc=new o.Icon(this.__id+"-ba-fc",this)),super.__previnit(),this.__element.append(this.__baFc.getElement()),this.baInterfaceHandler.baInterfaceDefinition=o.BaInterfaceDef,this.setBaInterfaceSymbolNames(o.BaInterfaceSymbolNames)}__init(){super.__init()}__attach(){super.__attach(),t.Helper.appendSourroundingElementsDimensionRectangle(this.__element,15),this.__destroyersToCallOnDetach.push(e.EventProvider.register(n.BuildingGeneral.BuildingInformation.BuildingInformantionEvents.onBuildingInformationChanged,()=>this.__onBuildingInformationChanged())),this.__onBuildingInformationChanged()}__detach(){super.__detach()}destroy(){var e,t;this.__keepAlive||(this.__destroySliders(),o.destroyBuildingInformationAlarms(this),null===(e=this.childrenHandler.getChildren().get(this.__id+"-reset-manual-operation-state-button"))||void 0===e||e.destroy(),null===(t=this.childrenHandler.getChildren().get(this.__id+"-operation-state-display"))||void 0===t||t.destroy(),super.destroy())}__onBuildingInformationChanged(){let e=o.handleBuildingInformation(this,this.__attrHandler.facadeName,this.__element.children(".alarm-container"));e?(this.__element.append(e),this.__baFc.backgroundStyler.setImageColor(t.Color.RGBAColor.Red)):(this.__element.children(".alarm-container").detach(),this.__baFc.backgroundStyler.setImageColor(null))}__destroyLayout(){switch(this.__closeControlContainer(),this.__removeAllControls(i.first),this.__removeAllControls(i.second),this.__attrHandler.controls){case o.Controls.sliderHorizontal:this.__destroySliders()}}__destroySliders(){var e;null!=this.__positionSlider&&(this.__positionSlider.destroy(),delete this.__positionSlider),null!=this.__angleSlider&&(null===(e=this.__angleSlider)||void 0===e||e.destroy(),delete this.__angleSlider),this.__destroyOnPositionSliderChanged&&(this.__destroyOnPositionSliderChanged(),delete this.__destroyOnPositionSliderChanged),this.__destroyOnPositionSliderFinished&&(this.__destroyOnPositionSliderFinished(),delete this.__destroyOnPositionSliderFinished),this.__destroyOnAngleSliderChanged&&(this.__destroyOnAngleSliderChanged(),delete this.__destroyOnAngleSliderChanged),this.__destroyOnAngleSliderFinished&&(this.__destroyOnAngleSliderFinished(),delete this.__destroyOnAngleSliderFinished)}__processChangedPosition(e){if(this.__useCurrentPosition=!0,this.setPosition(e),null!=this.__attrHandler.positionFeedback&&this.__attrHandler.position!=this.__attrHandler.positionFeedback){let e=()=>{this.__positionFeedbackReady.forEach(e=>e()),this.__positionFeedbackReady=[],this.setPosition(this.__attrHandler.positionFeedback)};this.__positionFeedbackReady.push(this.busyHandler.setBusy("Waiting for PositionFeedback",{cbOnTimeout:e,showIndicator:a.showBusyIndicator}))}}__processChangedAngle(e){if(this.__useCurrentAngle=!0,this.setAngle(e),null!=this.__attrHandler.angleFeedback&&this.__attrHandler.angle!=this.__attrHandler.angleFeedback){let e=()=>{this.__angleFeedbackReady.forEach(e=>e()),this.__angleFeedbackReady=[],this.setAngle(this.__attrHandler.angleFeedback)};this.__angleFeedbackReady.push(this.busyHandler.setBusy("Waiting for AngleFeedback",{cbOnTimeout:e,showIndicator:a.showBusyIndicator}))}}__updateElements(){let e=0,t=0;if(this.__attrHandler.usePosition&&null!=this.__attrHandler.position)e=this.__attrHandler.position,null!=this.__attrHandler.positionFeedback&&0==this.__useCurrentPosition&&(e=this.__attrHandler.positionFeedback),this.__useCurrentPosition=!1,this.__attrHandler.controls===o.Controls.sliderHorizontal&&null!=this.__positionSlider&&(this.__positionSlider.setValue(this.__attrHandler.position),null!=this.__attrHandler.positionFeedback&&this.__positionSlider.setValueFeedback(this.__attrHandler.positionFeedback)),this.__attrHandler.useAngle&&null!=this.__attrHandler.angle?(t=this.__attrHandler.angle,null!=this.__attrHandler.angleFeedback&&0==this.__useCurrentAngle&&(t=this.__attrHandler.angleFeedback),this.__useCurrentAngle=!1,this.__attrHandler.controls===o.Controls.sliderHorizontal&&null!=this.__angleSlider&&(this.__angleSlider.setValue(this.__attrHandler.angle),null!=this.__attrHandler.angleFeedback&&this.__angleSlider.setValueFeedback(this.__attrHandler.angleFeedback))):(null==this.__attrHandler.minAngle&&this.setMinAngle(0),null==this.__attrHandler.maxAngle&&this.setClosePosition(100),t=(this.__attrHandler.maxAngle-this.__attrHandler.minAngle)/2),this.__baFc.setAngle(t);else{null==this.__attrHandler.openPosition&&this.setOpenPosition(0),null==this.__attrHandler.closePosition&&this.setClosePosition(100);let n=(this.__attrHandler.closePosition-this.__attrHandler.openPosition)/2;switch(o.determinePositionState(this.__attrHandler.openFeedback,this.__attrHandler.closeFeedback)){case o.PositionState.opened:e=this.__attrHandler.openPosition;break;case o.PositionState.closed:e=this.__attrHandler.closePosition;break;default:e=n}null==this.__attrHandler.minAngle&&this.setMinAngle(0),null==this.__attrHandler.maxAngle&&this.setMaxAngle(100),t=(this.__attrHandler.maxAngle-this.__attrHandler.minAngle)/2}this.__updateDisplay(e,t),this.__baFc.setPosition(e)}__updateDisplay(e,t){if(null==e&&(e=0),e=o.getPercentagePosition(e,this.__attrHandler.closePosition,this.__attrHandler.openPosition),this.__attrHandler.showValue)if(this.__element.addClass("show-displays"),this.__baFc.getElement().append(this.__baFc.textHandler.getTextElement()),this.__attrHandler.usePosition)this.__attrHandler.useAngle?(null==t&&(t=0),null!=this.__attrHandler.openPosition&&null!=this.__attrHandler.closePosition&&null!=this.__attrHandler.minAngle&&null!=this.__attrHandler.maxAngle&&this.__baFc.textHandler.setText(e+"%  |  "+t.toFixed(0)+"Â°")):null!=this.__attrHandler.openPosition&&null!=this.__attrHandler.closePosition&&this.__baFc.textHandler.setText(e+"%");else{let e;switch(o.determinePositionState(this.__attrHandler.openFeedback,this.__attrHandler.closeFeedback)){case o.PositionState.opened:e="Opened";break;case o.PositionState.closed:e="Closed";break;default:e="Opened"}this.__baFc.textHandler.setText(e)}else this.__element.removeClass("show-displays"),this.__baFc.textHandler.setText(null),this.__baFc.textHandler.getTextElement().detach()}static processBaObject(e,n){var a,i;let l=e.baObjectHandler;if(null!=l)if(null===(a=l.baObject)||void 0===a?void 0:a.checkAddParams(o.BaInterfaceDef,o.BaInterfaceSymbolNames)){let e=l.baObject.tryGetBaVariable("fdbOpen");null!=e&&l.watchBaVariable(e,e=>{n.processOpenFeedback(e)});let t=l.baObject.tryGetBaVariable("fdbClose");null!=t&&l.watchBaVariable(t,e=>{n.processCloseFeedback(e)}),n.processHasResetSymbol(null!=l.baObject.tryGetBaVariable("resetManual"));let a=l.baObject.tryGetBaVariable("operationState");null!=a&&l.watchBaVariable(a,e=>{n.processOperationState(e)});let i=l.baObject.tryGetBaVariable("positionCmd");if(null!=i){n.processUsePosition(!0),l.watchBaVariable(i,e=>{n.processPosition(e)});let e=l.baObject.tryGetBaVariable("positionFdb");null!=e&&l.watchBaVariable(e,e=>{n.processPositionFeedback(e)})}else n.processUsePosition(!1);let r=l.baObject.tryGetBaVariable("angleCmd");if(null!=r){n.processUseAngle(!0),n.processMinAngle(o.DefaultMinimumAngle),n.processMaxAngle(o.DefaultMaximumAngle),l.watchBaVariable(r,e=>{n.processAngle(e)});let e=l.baObject.tryGetBaVariable("angleFdb");null!=e&&l.watchBaVariable(e,e=>{n.processAngleFeedback(e)});let t=l.baObject.tryGetBaVariable("minAngle");null!=t&&l.watchBaVariable(t,e=>{n.processMinAngle(e)});let a=l.baObject.tryGetBaVariable("maxAngle");null!=a&&l.watchBaVariable(a,e=>{n.processMaxAngle(e)})}else n.processUseAngle(!1)}else(null===(i=l.baObject)||void 0===i?void 0:i.checkTemplate(o.BaTemplateDefinition,e.baTemplateHandler.baBaTemplateDescription,e,!0))&&(l.tryWatchChildrenBaVariable(l.baObject.getTemplateChild("positionCommand"),t.BA.BaParameterId.ePresentValue,e=>{n.processPosition(e)}),l.tryWatchChildrenBaVariable(l.baObject.getTemplateChild("positionFeedback"),t.BA.BaParameterId.ePresentValue,e=>{n.processPositionFeedback(e)}),n.processUseAngle(!0),n.processMinAngle(o.DefaultMinimumAngle),n.processMaxAngle(o.DefaultMaximumAngle),l.tryWatchChildrenBaVariable(l.baObject.getTemplateChild("angleCommand"),t.BA.BaParameterId.ePresentValue,e=>{n.processAngle(e)}),l.tryWatchChildrenBaVariable(l.baObject.getTemplateChild("angleFeedback"),t.BA.BaParameterId.ePresentValue,e=>{n.processAngleFeedback(e)}))}static getOperationStateDisplayIcon(e){switch(e){case o.OperationState.safetyPosition:return t.Icons.RoomAutomation.SafetyPosition;case o.OperationState.maintenance:return t.Icons.RoomAutomation.MaintenancePosition;case o.OperationState.manual:return t.Icons.RoomAutomation.Manual;case o.OperationState.autoActive:case o.OperationState.autoInactive:return t.Icons.RoomAutomation.Automatic;default:return t.Logger.log(t.Logger.Severity.warn,`Invalid operation state '${e}'`),null}}static getOperationStateDisplayBackgroundAttributes(e){var n;if(!e)return{image:null,imageColor:null};let a={imageHeight:80,imageHeightUnit:"%",imageWidth:80,imageWidthUnit:"%",useSVG:!0};switch(a.image=null===(n=this.getOperationStateDisplayIcon(e))||void 0===n?void 0:n.path,e){case o.OperationState.safetyPosition:case o.OperationState.maintenance:case o.OperationState.manual:a.imageColor=t.Color.RGBAColor.DarkOrange;break;case o.OperationState.autoActive:a.imageColor=t.Color.RGBAColor.TcHmiGreen;break;case o.OperationState.autoInactive:a.imageColor=t.Color.RGBAColor.White}return a}static writeOpenToPlc(e){var n;e instanceof t.BA.BaBasicObject?null===(n=e.tryGetBaVariable("cmdUp"))||void 0===n||n.write(!0,e=>{t.Logger.checkServerResult(t.Logger.Severity.warn,e)}):e instanceof t.BaInterfaceHandler&&e.writeSubSymbol("cmdUp",!0).then(e=>{t.Logger.checkServerResult(t.Logger.Severity.warn,e)})}writeOpenToPlc(){var e;(null===(e=this.baObjectHandler.baObject)||void 0===e?void 0:e.checkAddParams(o.BaInterfaceDef,o.BaInterfaceSymbolNames))&&o.writeOpenToPlc(this.baObjectHandler.baObject),null!=this.baInterfaceHandler.getBaInterfaceSym()&&o.writeOpenToPlc(this.baInterfaceHandler)}static writeCloseToPlc(e){var n;e instanceof t.BA.BaBasicObject?null===(n=e.tryGetBaVariable("cmdDown"))||void 0===n||n.write(!0,e=>{t.Logger.checkServerResult(t.Logger.Severity.warn,e)}):e instanceof t.BaInterfaceHandler&&e.writeSubSymbol("cmdDown",!0).then(e=>{t.Logger.checkServerResult(t.Logger.Severity.warn,e)})}writeCloseToPlc(){var e;(null===(e=this.baObjectHandler.baObject)||void 0===e?void 0:e.checkAddParams(o.BaInterfaceDef,o.BaInterfaceSymbolNames))&&o.writeCloseToPlc(this.baObjectHandler.baObject),null!=this.baInterfaceHandler.getBaInterfaceSym()&&o.writeCloseToPlc(this.baInterfaceHandler)}static writePositionToPlc(e,n){var a,i;null!=e&&(n instanceof t.BA.BaView?null===(a=n.getTemplateChild("positionCommand"))||void 0===a||a.tryWriteBaVariableValue(t.BA.BaParameterId.ePresentValue,e,e=>{t.Logger.checkServerResult(t.Logger.Severity.warn,e)}):n instanceof t.BA.BaBasicObject?null===(i=n.tryGetBaVariable("positionCmd"))||void 0===i||i.write(e,e=>t.Logger.checkServerResult(t.Logger.Severity.warn,e)):n instanceof t.BaInterfaceHandler&&n.writeSubSymbol("positionCmd",e).then(e=>{t.Logger.checkServerResult(t.Logger.Severity.warn,e)}))}writePositionToPlc(e){var t,n;1!=this.busyHandler.getIsBusy()&&null!=e&&((null===(t=this.baObjectHandler.baObject)||void 0===t?void 0:t.checkTemplate(o.BaTemplateDefinition,this.baTemplateHandler.baBaTemplateDescription))&&o.writePositionToPlc(e,this.baObjectHandler.baObject),(null===(n=this.baObjectHandler.baObject)||void 0===n?void 0:n.checkAddParams(o.BaInterfaceDef,o.BaInterfaceSymbolNames))&&o.writePositionToPlc(e,this.baObjectHandler.baObject),null!=this.baInterfaceHandler.getBaInterfaceSym()&&o.writePositionToPlc(e,this.baInterfaceHandler),this.__processChangedPosition(e))}static writeAngleToPlc(e,n){var a,i;null!=e&&(n instanceof t.BA.BaView?null===(a=n.getTemplateChild("angleCommand"))||void 0===a||a.tryWriteBaVariableValue(t.BA.BaParameterId.ePresentValue,e,e=>{t.Logger.checkServerResult(t.Logger.Severity.warn,e)}):n instanceof t.BA.BaBasicObject?null===(i=n.tryGetBaVariable("angleCmd"))||void 0===i||i.write(e,e=>t.Logger.checkServerResult(t.Logger.Severity.warn,e)):n instanceof t.BaInterfaceHandler&&n.hasSubSymbol("angleCmd")&&n.writeSubSymbol("angleCmd",e).then(e=>{t.Logger.checkServerResult(t.Logger.Severity.warn,e)}))}writeAngleToPlc(e){var t,n;1!=this.busyHandler.getIsBusy()&&null!=e&&((null===(t=this.baObjectHandler.baObject)||void 0===t?void 0:t.checkTemplate(o.BaTemplateDefinition,this.baTemplateHandler.baBaTemplateDescription))&&o.writeAngleToPlc(e,this.baObjectHandler.baObject),(null===(n=this.baObjectHandler.baObject)||void 0===n?void 0:n.checkAddParams(o.BaInterfaceDef,o.BaInterfaceSymbolNames))&&o.writeAngleToPlc(e,this.baObjectHandler.baObject),null!=this.baInterfaceHandler.getBaInterfaceSym()&&o.writeAngleToPlc(e,this.baInterfaceHandler),this.__processChangedAngle(e))}static resetManualOperationStateToPlc(e){e instanceof t.BA.BaBasicObject?e.tryWriteBaVariableValue("resetManual",!0):e instanceof t.BaInterfaceHandler&&e.hasSubSymbol("resetManual")&&e.writeSubSymbol("resetManual",!0)}resetManualOperationStateToPlc(){var e;(null===(e=this.baObjectHandler.baObject)||void 0===e?void 0:e.checkAddParams(o.BaInterfaceDef,o.BaInterfaceSymbolNames))&&o.resetManualOperationStateToPlc(this.baObjectHandler.baObject),null!=this.baInterfaceHandler.getBaInterfaceSym()&&o.resetManualOperationStateToPlc(this.baInterfaceHandler)}static getPercentagePosition(e,n,a){return null!=e&&null!=n&&null!=a?Number(n>a?t.Helper.Number.toPercentage(e,a,n).toFixed(0):t.Helper.Number.toPercentage(e,n,a).toFixed(0)):null}static getBuildingInformation(e,a){let i=new t.Logger({name:e.getId()});if(null==a)return void i.log(t.Logger.Severity.debug,t.Logger.crossMark+"Facade name was not set. Sunblind is not able to collect facade info.");if(!n.BuildingGeneral.BuildingInformation.BuildingInformationInstances)return void i.log(t.Logger.Severity.debug,t.Logger.crossMark+"No BuildingInformation control was instanciated. Sunblind is not able to collect general building information.");let o=!1,l=n.BuildingGeneral.BuildingInformation.BuildingInformationInstances.find(e=>{let t=e.getFacades();if(!t)return!1;o=!0;for(let e=0;e<t.length;e++)if(t[e].name===a)return!0;return!1});if(o){if(l)return l;i.log(t.Logger.Severity.warn,t.Logger.crossMark+`No building information instance with a facade '${a}' was found!`)}}static handleBuildingInformation(e,a,i){var l;let r=o.getBuildingInformation(e,a);if(!r)return;let s=r.getAttributes(),d=null===(l=s.facades)||void 0===l?void 0:l.find(e=>e.name===a),_=[],h=[],c=t.CornerPosition.topRight,u=e.childrenHandler.getChild(e.getId()+"-fire-alarm");u&&!s.fireAlarm?(e.childrenHandler.removeChild(u),u.destroy()):s.fireAlarm&&(u||(u=new t.Components.Base(e.getId()+"-fire-alarm",e,{cssClass:"tchmi-ba-room-control-alarm-icon",background:{image:n.BuildingGeneral.BuildingInformation.getIcon(n.BuildingGeneral.BuildingInformation.Alarms.fire).path,imageColor:n.BuildingGeneral.BuildingInformation.getIconColor(n.BuildingGeneral.BuildingInformation.Alarms.fire,s.fireAlarm),useSVG:!0,imageWidth:80,imageWidthUnit:"%",imageHeight:80,imageHeightUnit:"%"}})),_.push(u),h.length<4&&(h.push({element:u.getElement(),position:c}),c++));let g=e.childrenHandler.getChild(e.getId()+"-burglar-alarm");g&&!s.burglarAlarm?(e.childrenHandler.removeChild(g),g.destroy()):s.burglarAlarm&&(g||(g=new t.Components.Base(e.getId()+"-burglar-alarm",e,{cssClass:"tchmi-ba-room-control-alarm-icon",background:{image:n.BuildingGeneral.BuildingInformation.getIcon(n.BuildingGeneral.BuildingInformation.Alarms.burglar).path,imageColor:n.BuildingGeneral.BuildingInformation.getIconColor(n.BuildingGeneral.BuildingInformation.Alarms.burglar,s.burglarAlarm),useSVG:!0,imageWidth:80,imageWidthUnit:"%",imageHeight:80,imageHeightUnit:"%"}})),_.push(g),h.length<4&&(h.push({element:g.getElement(),position:c}),c++));let p=e.childrenHandler.getChild(e.getId()+"-ice-alarm");p&&!s.iceAlarm?(e.childrenHandler.removeChild(p),p.destroy()):s.iceAlarm&&(p||(p=new t.Components.Base(e.getId()+"-ice-alarm",e,{cssClass:"tchmi-ba-room-control-alarm-icon",background:{image:n.BuildingGeneral.BuildingInformation.getIcon(n.BuildingGeneral.BuildingInformation.Alarms.ice).path,imageColor:n.BuildingGeneral.BuildingInformation.getIconColor(n.BuildingGeneral.BuildingInformation.Alarms.ice,s.iceAlarm),useSVG:!0,imageWidth:80,imageWidthUnit:"%",imageHeight:80,imageHeightUnit:"%"}})),_.push(p),h.length<4&&(h.push({element:p.getElement(),position:c}),c++));let m=e.childrenHandler.getChild(e.getId()+"-maintenance");m&&!d.maintenance?(e.childrenHandler.removeChild(m),m.destroy()):d.maintenance&&(m||(m=new t.Components.Base(e.getId()+"-maintenance",e,{cssClass:"tchmi-ba-room-control-alarm-icon",background:{image:n.BuildingGeneral.BuildingInformation.getIcon(n.BuildingGeneral.BuildingInformation.Alarms.maintenance).path,imageColor:n.BuildingGeneral.BuildingInformation.getIconColor(n.BuildingGeneral.BuildingInformation.Alarms.maintenance,d.maintenance),useSVG:!0,imageWidth:80,imageWidthUnit:"%",imageHeight:80,imageHeightUnit:"%"}})),_.push(m),h.length<4&&(h.push({element:m.getElement(),position:c}),c++));let b=e.childrenHandler.getChild(e.getId()+"-storm-protection");return b&&!d.stormProtection?(e.childrenHandler.removeChild(b),b.destroy()):d.stormProtection&&(b||(b=new t.Components.Base(e.getId()+"-storm-protection",e,{cssClass:"tchmi-ba-room-control-alarm-icon",background:{image:n.BuildingGeneral.BuildingInformation.getIcon(n.BuildingGeneral.BuildingInformation.Alarms.storm).path,imageColor:n.BuildingGeneral.BuildingInformation.getIconColor(n.BuildingGeneral.BuildingInformation.Alarms.storm,d.stormProtection),useSVG:!0,imageWidth:80,imageWidthUnit:"%",imageHeight:80,imageHeightUnit:"%"}})),_.push(b),h.length<4&&(h.push({element:b.getElement(),position:c}),c++)),h.length>0?(i&&null!=i[0]||(i=$("<div>").addClass("tchmi-ba-room-control-alarm-container")),t.Helper.appendSourroundingElements(i,h),e.setIsEnabled(!1),i):void e.setIsEnabled(!0)}static destroyBuildingInformationAlarms(e){var t,n,a,i,o;null===(t=e.childrenHandler.getChild(e.getId()+"-fire-alarm"))||void 0===t||t.destroy(),null===(n=e.childrenHandler.getChild(e.getId()+"-burglar-alarm"))||void 0===n||n.destroy(),null===(a=e.childrenHandler.getChild(e.getId()+"-ice-alarm"))||void 0===a||a.destroy(),null===(i=e.childrenHandler.getChild(e.getId()+"-maintenance"))||void 0===i||i.destroy(),null===(o=e.childrenHandler.getChild(e.getId()+"-storm-protection"))||void 0===o||o.destroy()}static determinePositionState(e,t){return null==e&&(e=!1),null==t&&(t=!1),e||t?e&&t?o.PositionState.invalid:e||!t?o.PositionState.opened:!e||t?o.PositionState.closed:o.PositionState.invalid:o.PositionState.moving}setBaObject(e){return this.baObjectHandler.setBaObject(e),this}getBaObject(){return this.baObjectHandler.baObject}setAttributes(e){return super.setAttributes(e),void 0!==e.openFeedback&&this.setOpenFeedback(e.openFeedback),void 0!==e.closeFeedback&&this.setCloseFeedback(e.closeFeedback),void 0!==e.usePosition&&this.setUsePosition(e.usePosition),void 0!==e.position&&this.setPosition(e.position),void 0!==e.positionFeedback&&this.setPositionFeedback(e.positionFeedback),void 0!==e.openPosition&&this.setOpenPosition(e.openPosition),void 0!==e.closePosition&&this.setClosePosition(e.closePosition),void 0!==e.useAngle&&this.setUseAngle(e.useAngle),void 0!==e.angle&&this.setAngle(e.angle),void 0!==e.minAngle&&this.setMinAngle(e.minAngle),void 0!==e.maxAngle&&this.setMaxAngle(e.maxAngle),void 0!==e.openedColor&&this.setOpenedColor(e.openedColor),void 0!==e.closedColor&&this.setClosedColor(e.closedColor),void 0!==e.slatColor&&this.setSlatColor(e.slatColor),void 0!==e.controls&&this.setControls(e.controls),void 0!==e.facadeName&&this.setFacadeName(e.facadeName),void 0!==e.operationState&&this.setOperationState(e.operationState),void 0!==e.showValue&&this.setShowValue(e.showValue),this}getAttributes(){return this.__attrHandler}setBaInterface(e){return super.setBaInterface(e),this.baInterfaceHandler.setBaInterfaceSym(e,()=>{o.processBaInterface(this,{processOpenFeedback:e=>this.setOpenFeedback(e),processCloseFeedback:e=>this.setCloseFeedback(e),processOperationState:e=>this.setOperationState(e),processHasResetSymbol:e=>this.__hasResetSymbol=e,processUsePosition:e=>this.setUsePosition(e),processPosition:e=>this.setPosition(e),processPositionFeedback:e=>this.setPositionFeedback(e),processUseAngle:e=>this.setUseAngle(e),processAngle:e=>this.setAngle(e),processAngleFeedback:e=>this.setAngleFeedback(e),processMaxAngle:e=>this.setMaxAngle(e),processMinAngle:e=>this.setMinAngle(e)})}),this}setOpenFeedback(t){let n=e.ValueConverter.toBoolean(t);return null==n&&(n=this.getAttributeDefaultValueInternal("OpenFeedback")),n===this.__attrHandler.openFeedback||(this.__attrHandler.openFeedback=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"OpenFeedback"}),this.__processOpenFeedback()),this}__processOpenFeedback(){this.__updateElements()}getOpenFeedback(){return this.__attrHandler.openFeedback}setCloseFeedback(t){let n=e.ValueConverter.toBoolean(t);return null==n&&(n=this.getAttributeDefaultValueInternal("CloseFeedback")),n===this.__attrHandler.closeFeedback||(this.__attrHandler.closeFeedback=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"CloseFeedback"}),this.__processCloseFeedback()),this}__processCloseFeedback(){this.__updateElements()}getCloseFeedback(){return this.__attrHandler.closeFeedback}setUsePosition(t){let n=e.ValueConverter.toBoolean(t);return null==n&&(n=this.getAttributeDefaultValueInternal("UsePosition")),n===this.__attrHandler.usePosition||(this.__attrHandler.usePosition=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"UsePosition"}),this.__processUsePosition()),this}__processUsePosition(){this.__processUseAngle(),this.__processControls(),this.__updateElements()}getUsePosition(){return this.__attrHandler.usePosition}setPosition(t){let n=e.ValueConverter.toNumber(t);return null==n&&(n=this.getAttributeDefaultValueInternal("Position")),n===this.__attrHandler.position||(this.__attrHandler.position=n,this.__processPosition(),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Position"}),e.EventProvider.raise(this.__id+".onPositionChanged")),this}__processPosition(){this.__updateElements()}getPosition(){return this.__attrHandler.position}setPositionFeedback(t){let n=e.ValueConverter.toNumber(t);return null==n&&(n=this.getAttributeDefaultValueInternal("PositionFeedback")),n===this.__attrHandler.positionFeedback||(this.__attrHandler.positionFeedback=n,null!=this.__attrHandler.positionFeedback&&(this.__processPositionFeedback(),this.__positionFeedbackReady.forEach(e=>e()),this.__positionFeedbackReady=[],e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"PositionFeedback"}))),this}__processPositionFeedback(){this.__updateElements()}getPositionFeedback(){return this.__attrHandler.positionFeedback}setOpenPosition(t){let n=e.ValueConverter.toNumber(t);return null==n&&(n=this.getAttributeDefaultValueInternal("OpenPosition")),n===this.__attrHandler.openPosition||(this.__attrHandler.openPosition=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"OpenPosition"}),this.__processOpenPosition()),this}__processOpenPosition(){this.__attrHandler.controls===o.Controls.sliderHorizontal&&null!=this.__positionSlider&&this.__positionSlider.setMaxValue(this.__attrHandler.openPosition),this.__baFc.setOpenPosition(this.__attrHandler.openPosition)}getOpenPosition(){return this.__attrHandler.openPosition}setClosePosition(t){let n=e.ValueConverter.toNumber(t);return null==n&&(n=this.getAttributeDefaultValueInternal("ClosePosition")),n===this.__attrHandler.closePosition||(this.__attrHandler.closePosition=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ClosePosition"}),this.__processClosePosition()),this}__processClosePosition(){this.__attrHandler.controls===o.Controls.sliderHorizontal&&null!=this.__positionSlider&&this.__positionSlider.setMinValue(this.__attrHandler.closePosition),this.__baFc.setClosePosition(this.__attrHandler.closePosition)}getClosePosition(){return this.__attrHandler.closePosition}setUseAngle(t){let n=e.ValueConverter.toBoolean(t);return null==n&&(n=this.getAttributeDefaultValueInternal("UseAngle")),n===this.__attrHandler.useAngle||(this.__attrHandler.useAngle=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"UseAngle"}),this.__processUseAngle()),this}__processUseAngle(){this.__attrHandler.useAngle&&this.__attrHandler.usePosition?this.__element.addClass("use-angle"):this.__element.removeClass("use-angle"),this.__processControls()}getUseAngle(){return this.__attrHandler.useAngle}setAngle(t){let n=e.ValueConverter.toNumber(t);return null==n&&(n=this.getAttributeDefaultValueInternal("Angle")),n===this.__attrHandler.angle||(this.__attrHandler.angle=n,this.__processAngle(),e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Angle"}),e.EventProvider.raise(this.__id+".onAngleChanged")),this}__processAngle(){this.__updateElements()}getAngle(){return this.__attrHandler.angle}setAngleFeedback(t){let n=e.ValueConverter.toNumber(t);return null==n&&(n=this.getAttributeDefaultValueInternal("AngleFeedback")),n===this.__attrHandler.angleFeedback||(this.__attrHandler.angleFeedback=n,null!=this.__attrHandler.angleFeedback&&(this.__attrHandler.angleFeedback=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"AngleFeedback"}),this.__processAngleFeedback(),this.__angleFeedbackReady.forEach(e=>e()),this.__angleFeedbackReady=[])),this}__processAngleFeedback(){this.__updateElements()}getAngleFeedback(){return this.__attrHandler.angleFeedback}setMinAngle(t){let n=e.ValueConverter.toNumber(t);return null==n&&(n=this.getAttributeDefaultValueInternal("MinAngle")),n===this.__attrHandler.minAngle||(this.__attrHandler.minAngle=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"MinAngle"}),this.__processMinAngle()),this}__processMinAngle(){this.__attrHandler.controls===o.Controls.sliderHorizontal&&null!=this.__angleSlider&&this.__angleSlider.setMinValue(this.__attrHandler.minAngle),this.__baFc.setMinAngle(this.__attrHandler.minAngle)}getMinAngle(){return this.__attrHandler.minAngle}setMaxAngle(t){let n=e.ValueConverter.toNumber(t);return null==n&&(n=this.getAttributeDefaultValueInternal("MaxAngle")),n===this.__attrHandler.maxAngle||(this.__attrHandler.maxAngle=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"MaxAngle"}),this.__processMaxAngle()),this}__processMaxAngle(){this.__attrHandler.controls===o.Controls.sliderHorizontal&&null!=this.__angleSlider&&this.__angleSlider.setMaxValue(this.__attrHandler.maxAngle),this.__baFc.setMaxAngle(this.__attrHandler.maxAngle)}getMaxAngle(){return this.__attrHandler.maxAngle}setAngleStep(t){let n=e.ValueConverter.toNumber(t);return null==n&&(n=this.getAttributeDefaultValueInternal("AngleStep")),n===this.__attrHandler.angleStep||(this.__attrHandler.angleStep=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"AngleStep"})),this}getAngleStep(){return this.__attrHandler.angleStep}setOpenedColor(n){let a=e.ValueConverter.toObject(n);return null==a&&(a=this.getAttributeDefaultValueInternal("OpenedColor")),null!=a&&!t.Color.isSolidColor(a)||void 0===a||tchmi_equal(a,this.__attrHandler.openedColor)||(null!=a&&e.isSolidColor(a)&&(a=t.Color.RGBAColor.fromSolidColor(a)),null==a||a instanceof t.Color.RGBAColor||(a=new t.Color.RGBAColor(a)),this.__attrHandler.openedColor=a,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"OpenedColor"}),this.__processOpenedColor()),this}__processOpenedColor(){this.__baFc.setOpenedColor(this.__attrHandler.openedColor)}getOpenedColor(){var e;return null===(e=this.__attrHandler.openedColor)||void 0===e?void 0:e.toSolidColor()}setClosedColor(n){let a=e.ValueConverter.toObject(n);return null==a&&(a=this.getAttributeDefaultValueInternal("ClosedColor")),null!=a&&!t.Color.isSolidColor(a)||void 0===a||tchmi_equal(a,this.__attrHandler.closedColor)||(null!=a&&e.isSolidColor(a)&&(a=t.Color.RGBAColor.fromSolidColor(a)),null==a||a instanceof t.Color.RGBAColor||(a=new t.Color.RGBAColor(a)),this.__attrHandler.closedColor=a,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ClosedColor"}),this.__processClosedColor()),this}__processClosedColor(){this.__baFc.setClosedColor(this.__attrHandler.closedColor)}getClosedColor(){var e;return null===(e=this.__attrHandler.closedColor)||void 0===e?void 0:e.toSolidColor()}setSlatColor(n){let a=e.ValueConverter.toObject(n);return null==a&&(a=this.getAttributeDefaultValueInternal("SlatColor")),null!=a&&!t.Color.isSolidColor(a)||void 0===a||tchmi_equal(a,this.__attrHandler.slatColor)||(null!=a&&e.isSolidColor(a)&&(a=t.Color.RGBAColor.fromSolidColor(a)),null==a||a instanceof t.Color.RGBAColor||(a=new t.Color.RGBAColor(a)),this.__attrHandler.slatColor=a,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SlatColor"}),this.__processSlatColor()),this}__processSlatColor(){this.__baFc.setSlatColor(this.__attrHandler.slatColor)}getSlatColor(){var e;return null===(e=this.__attrHandler.slatColor)||void 0===e?void 0:e.toSolidColor()}setFacadeName(t){let n=e.ValueConverter.toString(t);return null==n&&(n=this.getAttributeDefaultValueInternal("FacadeName")),n===this.__attrHandler.facadeName||(this.__attrHandler.facadeName=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"FacadeName"}),this.__processFacadeName()),this}__processFacadeName(){}getFacadeName(){return this.__attrHandler.facadeName}setControls(t){let n=e.ValueConverter.toString(t);return null==n&&(n=this.getAttributeDefaultValueInternal("Controls")),n===this.__attrHandler.controls||(this.__destroyLayout(),this.__attrHandler.controls=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Controls"}),this.__processControls()),this}__processControls(){if(!0!==this.__baFc.getReadOnly()){switch(this.__destroyLayout(),this.__attrHandler.controls){case o.Controls.sliderHorizontal:this.__element.removeClass("buttons-layout");let e={type:t.Components.ComponentType.Button,name:o.__positionDownButtonName,settings:{background:t.Components.BackgroundStyler.createImageConfig(t.Icons.Standard.Down.path,80)},callback:()=>{this.writeCloseToPlc()}},n={type:t.Components.ComponentType.Button,name:o.__positionUpButtonName,settings:{background:t.Components.BackgroundStyler.createImageConfig(t.Icons.Standard.Up.path,80)},callback:()=>{this.writeOpenToPlc()}};this.__attrHandler.usePosition?(this.__positionSlider=new t.Components.Slider(this.__id+"-position-slider",this),this.__positionSlider.setMinValue(void 0!==this.__attrHandler.closePosition?this.__attrHandler.closePosition:0).setMaxValue(void 0!==this.__attrHandler.openPosition?this.__attrHandler.openPosition:100).setShowScale(!1).setShowValue(!1).setShowBusyIndicator(a.showBusyIndicator).layoutHandler.setMaxHeight(19).setMinHeight(19),this.__destroyersToCallOnDestroy.push(t.Locale.Localization.watchText(t.Locale.LangKey.Position,e=>{var n;t.Logger.checkServerResult(t.Logger.Severity.warn,e)&&(null===(n=this.__positionSlider)||void 0===n||n.textHandler.setText(e.text))})),this.__destroyOnPositionSliderChanged=this.__positionSlider.eventHandler.register(t.Components.Slider.SliderEvents.onValueChanged,()=>{null!=this.__positionSlider&&(this.__baFc.setPosition(this.__positionSlider.getValue()),this.__updateDisplay(this.__positionSlider.getValue(),this.__attrHandler.angle))}),this.__destroyOnPositionSliderFinished=this.__positionSlider.eventHandler.register(t.Components.Slider.SliderEvents.onUserInteractionFinished,()=>{null!=this.__positionSlider&&this.writePositionToPlc(this.__positionSlider.getValue())}),this.__addControls(i.first,[e,this.__positionSlider,n],1),this.__attrHandler.useAngle&&(o.UseButtonsForAngle?this.__addControls(i.second,[{type:t.Components.ComponentType.Button,name:o.__angleMinusButtonName,settings:{background:t.Components.BackgroundStyler.createImageConfig(t.Icons.RoomAutomation.SunblindAngleAdjustmentDown.path,80)},callback:(e,t,n)=>{var a;if(null!=this.__attrHandler.angle){let e=this.__attrHandler.angle-(null!=this.__attrHandler.angleStep?this.__attrHandler.angleStep:15);null!=this.__attrHandler.maxAngle&&null!=this.__attrHandler.minAngle&&(this.__attrHandler.maxAngle>this.__attrHandler.minAngle?(e<this.__attrHandler.minAngle||e==this.__attrHandler.minAngle)&&(e=this.__attrHandler.minAngle,null==n||n.setIsEnabled(!1)):(e<this.__attrHandler.maxAngle||e==this.__attrHandler.maxAngle)&&(e=this.__attrHandler.maxAngle,null==n||n.setIsEnabled(!1))),this.writeAngleToPlc(e),null===(a=this.__getControl(i.second,o.__anglePlusButtonName))||void 0===a||a.setIsEnabled(!0)}}},{type:t.Components.ComponentType.Button,name:o.__anglePlusButtonName,settings:{background:t.Components.BackgroundStyler.createImageConfig(t.Icons.RoomAutomation.SunblindAngleAdjustmentUp.path,80)},callback:(e,t,n)=>{var a;if(null!=this.__attrHandler.angle){let e=this.__attrHandler.angle+(null!=this.__attrHandler.angleStep?this.__attrHandler.angleStep:15);null!=this.__attrHandler.maxAngle&&null!=this.__attrHandler.minAngle&&(this.__attrHandler.maxAngle>this.__attrHandler.minAngle?(e>this.__attrHandler.maxAngle||e==this.__attrHandler.minAngle)&&(e=this.__attrHandler.maxAngle,null==n||n.setIsEnabled(!1)):(e>this.__attrHandler.minAngle||e==this.__attrHandler.maxAngle)&&(e=this.__attrHandler.minAngle,null==n||n.setIsEnabled(!1))),this.writeAngleToPlc(e),null===(a=this.__getControl(i.second,o.__angleMinusButtonName))||void 0===a||a.setIsEnabled(!0)}}}],2):(null==this.__angleSlider&&(this.__angleSlider=new t.Components.Slider(this.__id+"-angle-slider",this),this.__angleSlider.setShowScale(!1).setShowValue(!1).setSwitchMinMax(!0).setShowBusyIndicator(a.showBusyIndicator).layoutHandler.setMaxHeight(19).setMinHeight(19),this.__destroyersToCallOnDestroy.push(t.Locale.Localization.watchText(t.Locale.LangKey.Angle,e=>{var n;t.Logger.checkServerResult(t.Logger.Severity.warn,e)&&(null===(n=this.__angleSlider)||void 0===n||n.textHandler.setText(e.text))})),this.__destroyOnAngleSliderChanged=this.__angleSlider.eventHandler.register(t.Components.Slider.SliderEvents.onValueChanged,()=>{null!=this.__angleSlider&&(this.__baFc.setAngle(this.__angleSlider.getValue()),this.__updateDisplay(this.__attrHandler.position,this.__angleSlider.getValue()))}),this.__destroyOnAngleSliderFinished=this.__angleSlider.eventHandler.register(t.Components.Slider.SliderEvents.onUserInteractionFinished,()=>{null!=this.__angleSlider&&this.writeAngleToPlc(this.__angleSlider.getValue())}),this.__addControl(i.second,this.__angleSlider,2)),this.__angleSlider.setMinValue(this.__attrHandler.minAngle).setMaxValue(this.__attrHandler.maxAngle)))):this.__addControls(i.first,[e,n],1);break;default:this.__element.addClass("buttons-layout");let l=["up-button-step","up-button-complete","down-button-step","down-button-complete"],r=0;for(let e of l){if(null==this.__getControl(i.first,e)&&null==this.__getControl(i.second,e)){let n="",a=80,o=t.Components.ComponentType.Button;switch(e){case"up-button-step":n=t.Icons.Standard.Up.path;break;case"up-button-complete":n=t.Icons.Standard.Up_double.path;break;case"down-button-step":n=t.Icons.Standard.Down.path;break;case"down-button-complete":n=t.Icons.Standard.Down_double.path}let l={type:o,name:e,settings:{background:{imageHeight:a,imageHeightUnit:"%",imageWidth:a,imageWidthUnit:"%",image:n}},callback:()=>{switch(e){case"up-button-step":this.__angleMode?null!=this.__attrHandler.maxAngle&&null!=this.__attrHandler.minAngle&&null!=this.__attrHandler.angle&&null!=this.__attrHandler.angleStep&&this.writeAngleToPlc(t.Helper.Number.addStep(this.__attrHandler.angle,this.__attrHandler.minAngle,this.__attrHandler.maxAngle,this.__attrHandler.angleStep)):null!=this.__attrHandler.openPosition&&null!=this.__attrHandler.openPosition&&null!=this.__attrHandler.position&&null!=this.__positionStep&&this.writePositionToPlc(t.Helper.Number.addStep(this.__attrHandler.position,this.__attrHandler.openPosition,this.__attrHandler.openPosition,this.__positionStep));break;case"up-button-complete":this.__angleMode&&null!=this.__attrHandler.maxAngle?this.writeAngleToPlc(this.__attrHandler.maxAngle):null!=this.__attrHandler.openPosition&&this.writePositionToPlc(this.__attrHandler.openPosition);break;case"down-button-step":this.__angleMode?null!=this.__attrHandler.minAngle&&null!=this.__attrHandler.maxAngle&&null!=this.__attrHandler.angle&&null!=this.__attrHandler.angleStep&&this.writeAngleToPlc(t.Helper.Number.removeStep(this.__attrHandler.angle,this.__attrHandler.minAngle,this.__attrHandler.maxAngle,this.__attrHandler.angleStep)):null!=this.__attrHandler.closePosition&&null!=this.__attrHandler.openPosition&&null!=this.__attrHandler.position&&null!=this.__positionStep&&this.writePositionToPlc(t.Helper.Number.removeStep(this.__attrHandler.position,this.__attrHandler.openPosition,this.__attrHandler.closePosition,this.__positionStep));break;case"down-button-complete":this.__angleMode&&null!=this.__attrHandler.minAngle?this.writeAngleToPlc(this.__attrHandler.minAngle):null!=this.__attrHandler.openPosition&&this.writePositionToPlc(this.__attrHandler.openPosition)}}};r<=1?this.__addControl(i.first,l,1):this.__addControl(i.second,l,2)}r++}}this.__updateElements()}}getControls(){return this.__attrHandler.controls}setOperationState(t){let n=e.ValueConverter.toNumber(t);return null==n&&(n=this.getAttributeDefaultValueInternal("OperationState")),n===this.__attrHandler.operationState||(this.__attrHandler.operationState=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"OperationState"}),this.__processOperationState()),this}__processOperationState(){var e;if(this.__attrHandler.operationState){this.__appendOperationStateDisplay(!0),null===(e=this.__operationStateDisplay)||void 0===e||e.backgroundStyler.setAttributes(o.getOperationStateDisplayBackgroundAttributes(this.__attrHandler.operationState));let t=o.getOperationStateDisplayIcon(this.__attrHandler.operationState);null!=t&&(this.__operationStateLegenIconHandler.icon=t,this.__isAttached&&this.__operationStateLegenIconHandler.show()),this.__attrHandler.operationState!=o.OperationState.manual?this.__appendResetManualOperationStateButton(!1):this.__attrHandler.operationState===o.OperationState.manual&&this.__hasResetSymbol&&this.__appendResetManualOperationStateButton(!0)}else this.__appendOperationStateDisplay(!1),this.__appendResetManualOperationStateButton(!1),this.__operationStateLegenIconHandler.hide()}getOperationState(){return this.__attrHandler.operationState}setShowValue(t){let n=e.ValueConverter.toBoolean(t);return null==n&&(n=this.getAttributeDefaultValueInternal("ShowValue")),n===this.__attrHandler.showValue||(this.__attrHandler.showValue=n,e.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowValue"}),this.__processShowValue()),this}__processShowValue(){this.__updateElements()}getShowValue(){return this.__attrHandler.showValue}processBaObject(){super.processBaObject(),o.processBaObject(this,{processOpenFeedback:e=>this.setOpenFeedback(e),processCloseFeedback:e=>this.setCloseFeedback(e),processHasResetSymbol:e=>this.__hasResetSymbol=e,processOperationState:e=>{this.setOperationState(e)},processUsePosition:e=>this.setUsePosition(e),processPosition:e=>this.setPosition(e),processPositionFeedback:e=>this.setPositionFeedback(e),processUseAngle:e=>this.setUseAngle(e),processAngle:e=>this.setAngle(e),processAngleFeedback:e=>this.setAngleFeedback(e),processMaxAngle:e=>this.setMaxAngle(e),processMinAngle:e=>this.setMinAngle(e)})}__processReadOnly(){super.__processReadOnly(),!0===this.__baFc.getReadOnly()?this.__destroyLayout():this.__processControls()}static processBaInterface(e,t){e.baInterfaceHandler.hasSubSymbol("fdbOpen")&&e.baInterfaceHandler.watchSubSymbol("fdbOpen",e=>{t.processOpenFeedback(e)}),e.baInterfaceHandler.hasSubSymbol("fdbClose")&&e.baInterfaceHandler.watchSubSymbol("fdbClose",e=>{t.processCloseFeedback(e)}),t.processHasResetSymbol(e.baInterfaceHandler.hasSubSymbol("resetManual")),e.baInterfaceHandler.hasSubSymbol("operationState")&&e.baInterfaceHandler.watchSubSymbol("operationState",e=>{t.processOperationState(e)}),e.baInterfaceHandler.hasSubSymbol("positionCmd")?(t.processUsePosition(!0),e.baInterfaceHandler.watchSubSymbol("positionCmd",e=>{t.processPosition(e)}),e.baInterfaceHandler.hasSubSymbol("positionFdb")&&e.baInterfaceHandler.watchSubSymbol("positionFdb",e=>{t.processPositionFeedback(e)})):t.processUsePosition(!1),e.baInterfaceHandler.hasSubSymbol("angleCmd")?(t.processUseAngle(!0),e.baInterfaceHandler.watchSubSymbol("angleCmd",e=>{t.processAngle(e)}),e.baInterfaceHandler.hasSubSymbol("angleFdb")&&e.baInterfaceHandler.watchSubSymbol("angleFdb",e=>{t.processAngleFeedback(e)}),e.baInterfaceHandler.hasSubSymbol("minAngle")&&e.baInterfaceHandler.watchSubSymbol("minAngle",e=>{t.processMinAngle(e)}),e.baInterfaceHandler.hasSubSymbol("maxAngle")&&e.baInterfaceHandler.watchSubSymbol("maxAngle",e=>{t.processMaxAngle(e)})):t.processUseAngle(!1)}}o.__positionUpButtonName="position-up-button",o.__positionDownButtonName="position-down-button",o.__anglePlusButtonName="angle-plus-button",o.__angleMinusButtonName="angle-minus-button",a.Sunblind=o,function(a){let i,o,l;a.DefaultMinimumAngle=27,a.DefaultMaximumAngle=-69,a.UseButtonsForAngle=!0,a.BaTemplateDefinition={positionFeedback:{},positionCommand:{},angleFeedback:{optional:!0},angleCommand:{optional:!0}},a.BaTemplateDescription={positionFeedback:{identifier:"ActlPos"},positionCommand:{identifier:"LocInputPos"},angleFeedback:{identifier:"ActlAngl"},angleCommand:{identifier:"LocInputAngl"}},a.BaInterfaceDef=Object.assign(Object.assign({},n.System.BaseRoomControl.BaInterfaceDef),{cmdUp:{type:"boolean"},cmdDown:{type:"boolean"},fdbOpen:{type:"boolean",optional:!0},fdbClose:{type:"boolean",optional:!0},initialize:{type:"boolean",optional:!0},operationState:{type:"integer",optional:!0},resetManual:{type:"boolean",optional:!0},positionCmd:{type:"number",optional:!0},positionFdb:{type:"number",optional:!0},angleCmd:{type:"number",optional:!0},angleFdb:{type:"number",optional:!0},minAngle:{type:"number",optional:!0},maxAngle:{type:"number",optional:!0}}),a.BaInterfaceSymbolNames=Object.assign(Object.assign({},n.System.BaseRoomControl.BaInterfaceSymbolNames),{cmdUp:{symbolName:"bUp_In"},cmdDown:{symbolName:"bDown_In"},fdbOpen:{symbolName:"bOpened_Out"},fdbClose:{symbolName:"bClosed_Out"},initialize:{symbolName:"bInitialize_In"},operationState:{symbolName:"eOperationalState_Out"},resetManual:{symbolName:"bResetManual_In"},positionCmd:{symbolName:"fSunblindPosition_In"},positionFdb:{symbolName:"fSunblindPosition_Out"},angleCmd:{symbolName:"fSunblindAngle_In"},angleFdb:{symbolName:"fSunblindAngle_Out"},minAngle:{symbolName:"fAnglLmtDwn"},maxAngle:{symbolName:"fAnglLmtUp"}}),function(e){e.buttons="buttons",e.sliderHorizontal="sliderHorizontal"}(i=a.Controls||(a.Controls={})),function(e){e[e.invalid=0]="invalid",e[e.autoActive=1]="autoActive",e[e.manual=2]="manual",e[e.autoInactive=3]="autoInactive",e[e.maintenance=4]="maintenance",e[e.safetyPosition=5]="safetyPosition"}(o=a.OperationState||(a.OperationState={})),function(e){e[e.invalid=0]="invalid",e[e.closed=1]="closed",e[e.opened=2]="opened",e[e.moving=3]="moving"}(l=a.PositionState||(a.PositionState={}));class r extends t.Components.Button{constructor(e,t,n){super(e,t,n),this.smallMode=!1,this.__useSmallImage=!1}__init(n){var a,i;super.__init(n),this.resizeHandler=new t.Components.ResizeHandler(this),this.__legendIconHandler=new t.Components.LegendIconHandler,void 0===(null===(a=null==n?void 0:n.background)||void 0===a?void 0:a.imageHeight)&&this.backgroundStyler.setImageHeight(95,"%"),void 0===(null===(i=null==n?void 0:n.background)||void 0===i?void 0:i.imageWidth)&&this.backgroundStyler.setImageWidth(95,"%"),this.backgroundStyler.setImage(e.Controls.getBasePath("TcHmi.BuildingAutomation.Controls.RoomAutomation.Sunblind")+"/Images/SunblindSlats.svg",!0),this.__legendIconHandler.icon=t.Icons.RoomAutomation.Sunblind}__attach(){this.__isAttached||(null!=this.__legendIconHandler.icon&&this.__legendIconHandler.show(),this.eventHandler.register(t.Components.BackgroundStyler.Events.onSvgLoaded,e=>{e.destroy(),this.__animatePosition(),this.__animateAngle(),this.__animateSunExposure(),this.__processSlatColor()}),super.__attach())}__detach(){this.__isAttached&&(this.__legendIconHandler.hide(),super.__detach())}destroy(){super.destroy()}onResized(){let n=this.__element[0].getBoundingClientRect(),a=n.height;n.width<70||a<70?(this.backgroundStyler.setImage(e.Controls.getBasePath("TcHmi.BuildingAutomation.Controls.RoomAutomation.Sunblind")+"/Images/SunblindSlats_small.svg",!0),this.__useSmallImage=!0):(this.backgroundStyler.setImage(e.Controls.getBasePath("TcHmi.BuildingAutomation.Controls.RoomAutomation.Sunblind")+"/Images/SunblindSlats.svg",!0),this.__useSmallImage=!1),this.eventHandler.register(t.Components.BackgroundStyler.Events.onSvgLoaded,e=>{this.__animatePosition(),this.__animateAngle()})}__animatePosition(){if(!this.__isAttached)return;let e=this.backgroundStyler.getSvg();if(null==e)return;let t=e.find(".sunblind-slats");if(null==t[0])return;let n=0;null!=this.__attrHandler.openPosition&&null!=this.__attrHandler.closePosition&&null!=this.__attrHandler.position&&(n=100/(this.__attrHandler.closePosition-this.__attrHandler.openPosition)*this.__attrHandler.position-this.__attrHandler.closePosition),(n>0||isNaN(n))&&(n=-100),t.css("transform",`translate(0px, ${n}px)`),t.css("transition","transform 200ms linear")}__animateAngle(){if(!this.__isAttached)return;null==this.__attrHandler.angle&&(this.__attrHandler.angle=0,null!=this.__attrHandler.minAngle&&null!=this.__attrHandler.maxAngle&&(this.__attrHandler.angle=(this.__attrHandler.maxAngle-this.__attrHandler.minAngle)/2));let e=this.backgroundStyler.getSvg();if(null==e)return;let t=6;this.__useSmallImage&&(t=16),null!=this.__attrHandler.minAngle&&null!=this.__attrHandler.maxAngle&&null!=this.__attrHandler.angle&&(t=t/(this.__attrHandler.maxAngle-this.__attrHandler.minAngle)*(this.__attrHandler.angle-this.__attrHandler.minAngle),!this.__useSmallImage&&t<2&&(t=2),this.__useSmallImage&&t<4&&(t=4)),e.css("--tchmi-ba-sunblind-slat-stroke-width",t+"px")}__animateSunExposure(){let e=this.backgroundStyler.getSvg();if(e)if(null==this.__attrHandler.closedColor||null==this.__attrHandler.openedColor)e.css("background","");else if(null==this.__attrHandler.openPosition||null==this.__attrHandler.closePosition||null==this.__attrHandler.position)e.css("background",this.__attrHandler.closedColor.toString());else{let n=100/(this.__attrHandler.openPosition-this.__attrHandler.closePosition)*(this.__attrHandler.position-this.__attrHandler.openPosition);null!=this.__attrHandler.minAngle&&null!=this.__attrHandler.maxAngle&&null!=this.__attrHandler.angle&&(n=n+40-40/(this.__attrHandler.maxAngle-this.__attrHandler.minAngle)*(this.__attrHandler.angle-this.__attrHandler.minAngle)),e.css("background",t.Color.getFadeColor(this.__attrHandler.closedColor,0,this.__attrHandler.openedColor,100,n).toString())}}setAttributes(e){return super.setAttributes(e),void 0!==e.position&&this.setPosition(e.position),void 0!==e.openPosition&&this.setOpenPosition(e.openPosition),void 0!==e.closePosition&&this.setClosePosition(e.closePosition),void 0!==e.angle&&this.setAngle(e.angle),void 0!==e.minAngle&&this.setMinAngle(e.minAngle),void 0!==e.maxAngle&&this.setMaxAngle(e.maxAngle),void 0!==e.openedColor&&this.setOpenedColor(e.openedColor),void 0!==e.closedColor&&this.setClosedColor(e.closedColor),void 0!==e.slatColor&&this.setSlatColor(e.slatColor),this}getAttributes(){return this.__attrHandler.getRef()}setPosition(e){return this.__attrHandler.checkAttribute(e,"position",{validator:"number"})?(this.__attrHandler.position=e,this.__processPosition(),this):this}__processPosition(){this.__animatePosition(),this.__animateSunExposure()}getPosition(){return this.__attrHandler.position}setOpenPosition(e){return this.__attrHandler.checkAttribute(e,"openPosition",{validator:"number"})?(this.__attrHandler.openPosition=e,this.__processPosition(),this):this}getOpenPosition(){return this.__attrHandler.openPosition}setClosePosition(e){return this.__attrHandler.checkAttribute(e,"closePosition",{validator:"number"})?(this.__attrHandler.closePosition=e,this.__processPosition(),this):this}getClosePosition(){return this.__attrHandler.closePosition}setAngle(e){return this.__attrHandler.checkAttribute(e,"angle",{validator:"number"})?(this.__attrHandler.angle=e,this.__processAngle(),this):this}__processAngle(){this.__animateAngle(),this.__animateSunExposure()}getAngle(){return this.__attrHandler.angle}setMinAngle(e){return this.__attrHandler.checkAttribute(e,"minAngle",{validator:"number"})?(this.__attrHandler.minAngle=e,this.__processAngle(),this):this}getMinAngle(){return this.__attrHandler.minAngle}setMaxAngle(e){return this.__attrHandler.checkAttribute(e,"maxAngle",{validator:"number"})?(this.__attrHandler.maxAngle=e,this.__processAngle(),this):this}getMaxAngle(){return this.__attrHandler.maxAngle}setOpenedColor(e){return this.__attrHandler.checkColorAttribute(e,"openedColor")?(this.__attrHandler.openedColor=e,this.__processOpenedColor(),this):this}__processOpenedColor(){this.__animateSunExposure()}getOpenedColor(){return this.__attrHandler.openedColor}setClosedColor(e){return this.__attrHandler.checkColorAttribute(e,"closedColor")?(this.__attrHandler.closedColor=e,this.__processClosedColor(),this):this}__processClosedColor(){this.__animateSunExposure()}getClosedColor(){return this.__attrHandler.closedColor}setSlatColor(e){return this.__attrHandler.checkColorAttribute(e,"slatColor")?(this.__attrHandler.slatColor=e,this.__processSlatColor(),this):this}__processSlatColor(){var e;let t=this.backgroundStyler.getSvg();if(null==t)return;let n=t.find(".sunblind-slats");if(null==n[0])return;let a=null===(e=this.__attrHandler.slatColor)||void 0===e?void 0:e.toString();a?n.css("stroke",a):n.css("stroke","rgb(120, 120. 120)")}getSlatColor(){return this.__attrHandler.slatColor}__processReadOnly(){super.__processReadOnly(),!0===this.__attrHandler.readOnly?this.__element.removeClass("button"):this.__element.addClass("button")}}a.Icon=r}(o=a.Sunblind||(a.Sunblind={}))})((n=t.Controls||(t.Controls={})).RoomAutomation||(n.RoomAutomation={}))}(e.BuildingAutomation||(e.BuildingAutomation={}))}(TcHmi||(TcHmi={})),TcHmi.Controls.registerEx("Sunblind","TcHmi.BuildingAutomation.Controls.RoomAutomation",TcHmi.BuildingAutomation.Controls.RoomAutomation.Sunblind);