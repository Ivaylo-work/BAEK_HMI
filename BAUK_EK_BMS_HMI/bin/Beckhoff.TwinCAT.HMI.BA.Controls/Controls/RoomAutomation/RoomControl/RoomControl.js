var TcHmi,__awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function l(t){try{r(i.next(t))}catch(t){s(t)}}function a(t){try{r(i.throw(t))}catch(t){s(t)}}function r(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,a)}r((i=i.apply(t,e||[])).next())}))};!function(t){!function(e){!function(n){!function(i){let o;i.showBusyIndicator=!1,i.ignoreBaObjectAccess=!1,function(o){class s extends n.System.TextControl{constructor(t,n,i){super(t,n,i),this.__loadBaChildren=!0,this.resizeHandler=new e.Components.ResizeHandler(this),this.__roomStatus=new e.Components.ControlContainer(this.__id+"-room-status",this),this.__controlUnitHeader={},this.__controlUnits=[],this.__sideMenuOpen=!1,this.__ctrlCnt={sunblind:0,light:0,hc:0,window:0},this.__useCurrentValues=!1,this.__currentlyAddedControlUnits=[],this.__pressedHandler=t=>this.__onPressed(t),this.__windowPressedHandler=t=>this.__onWindowPressed(t)}get sideMenuOpen(){return this.__sideMenuOpen}__previnit(){super.__previnit(),this.baObjectHandler=new e.BaObjectHandler(this),this.eventHandler=new e.EventHandler(this),this.__presenceLegendIconHandler=new e.Components.LegendIconHandler,this.__presenceLegendIconHandler.icon=e.Icons.RoomAutomation.Presence,this.__switchOffDelayLegendIconHandler=new e.Components.LegendIconHandler,this.__switchOffDelayLegendIconHandler.icon=e.Icons.RoomAutomation.SwitchOffDelay,this.__roomStatus.getElement().addClass("control-unit"),this.__element.append(this.__roomStatus.getElement()),null==this.__attrHandler.lights&&(this.__attrHandler.lights={}),void 0===this.__attrHandler.lights.baInterfaceSymbolNames&&(this.__attrHandler.lights.baInterfaceSymbolNames=i.Light.BaInterfaceSymbolNames),void 0===this.__attrHandler.lights.baBaTemplateDescription&&(this.__attrHandler.lights.baBaTemplateDescription=i.Light.BaTemplateDescription),null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),void 0===this.__attrHandler.sunblinds.baInterfaceSymbolNames&&(this.__attrHandler.sunblinds.baInterfaceSymbolNames=i.Sunblind.BaInterfaceSymbolNames),void 0===this.__attrHandler.sunblinds.baBaTemplateDescription&&(this.__attrHandler.sunblinds.baBaTemplateDescription=i.Sunblind.BaTemplateDescription),null==this.__attrHandler.hcs&&(this.__attrHandler.hcs={}),void 0===this.__attrHandler.hcs.tempAdjustRange&&this.setTempAdjustRange(3),void 0===this.__attrHandler.hcs.baInterfaceSymbolNames&&(this.__attrHandler.hcs.baInterfaceSymbolNames=i.HeatingCooling.BaInterfaceSymbolNames),void 0===this.__attrHandler.hcs.baBaTemplateDescription&&(this.__attrHandler.hcs.baBaTemplateDescription=i.HeatingCooling.BaTemplateDescription),null==this.__attrHandler.windows&&(this.__attrHandler.windows={}),void 0===this.__attrHandler.windows.baInterfaceSymbolNames&&(this.__attrHandler.windows.baInterfaceSymbolNames=i.Window.BaInterfaceSymbolNames),void 0===this.__attrHandler.windows.baBaTemplateDescription&&(this.__attrHandler.windows.baBaTemplateDescription=i.Window.BaTemplateDescription)}__init(){super.__init()}__attach(){super.__attach(),null!=this.__presenceLegendIconHandler.icon&&this.__presenceLegendIconHandler.show(),null!=this.__switchOffDelayLegendIconHandler.icon&&this.__switchOffDelayLegendIconHandler.show(),this.__element.on("pointerdown",this.__pressedHandler),this.__processSwitchOffDelayActive(),this.__processPresence()}__detach(){var t,n;super.__detach(),this.__presenceLegendIconHandler.hide(),this.__switchOffDelayLegendIconHandler.hide(),this.__element.off("pointerdown",this.__pressedHandler),null===(t=this.__sideMenu)||void 0===t||t.off("mousedown click touchstart",e.EventHandler.stopPropagationHandler),null===(n=this.__sideMenu)||void 0===n||n.detach()}destroy(){var t,e,n,i,o,s,l,a,r,d,_,h,u,c;this.__keepAlive||(this.__controlUnits.forEach(t=>t.destroy()),null===(t=this.__headerSideMenu)||void 0===t||t.destroy(),this.__roomStatus.destroy(),null===(e=this.__roomStatusSideMenu)||void 0===e||e.destroy(),null===(n=this.__controlUnitHeader.light)||void 0===n||n.healine.destroy(),null===(o=null===(i=this.__controlUnitHeader.light)||void 0===i?void 0:i.controls)||void 0===o||o.destroy(),null===(s=this.__controlUnitHeader.sunblind)||void 0===s||s.healine.destroy(),null===(a=null===(l=this.__controlUnitHeader.sunblind)||void 0===l?void 0:l.controls)||void 0===a||a.destroy(),null===(r=this.__controlUnitHeader.hc)||void 0===r||r.healine.destroy(),null===(_=null===(d=this.__controlUnitHeader.hc)||void 0===d?void 0:d.controls)||void 0===_||_.destroy(),null===(h=this.__controlUnitHeader.window)||void 0===h||h.healine.destroy(),null===(c=null===(u=this.__controlUnitHeader.window)||void 0===u?void 0:u.controls)||void 0===c||c.destroy(),this.resizeHandler.destroy(),super.destroy())}onResized(){let t=this.__element.innerHeight(),e=0;if(this.__attrHandler.hideRoomStatus||(e=1),null!=t&&t>0){e+=this.__controlUnits.length;for(let t=0;t<this.__controlUnits.length;t++)(!this.__attrHandler.showLights&&this.__controlUnits[t]instanceof o.LightControl||!this.__attrHandler.showSunblinds&&this.__controlUnits[t]instanceof o.SunblindControl||!this.__attrHandler.showAirConditionings&&this.__controlUnits[t]instanceof o.HeatingCoolingControl||!this.__attrHandler.showWindows&&this.__controlUnits[t]instanceof o.WindowControl)&&e--;t/=e,t>40?this.__element.css("--control-unit-height","40px"):this.__element.css("--control-unit-height",t+"px")}}__onPressed(n){if(null!=n.button&&0!=n.button)return;if(0==this.getIsEnabled()||0==t.Access.checkAccess(this,e.Server.UserManagement.AccessRight.operate))return;this.__element.addClass("down"),$(window).off("pointerdown",this.__windowPressedHandler);let i=()=>{this.__toggleMenu(),this.__element.off("pointerup",i)};this.__element.on("pointerup",i);let o=()=>{this.__element.removeClass("down"),$(window).off("pointerup",o),this.__element.off("pointerup",i)};$(window).on("pointerup",o)}__onWindowPressed(t){let e=$(t.target);e.hasClass("tchmi-ba-room-control-side-menu")||null!=e.parents(".tchmi-ba-room-control-side-menu")[0]||this.__toggleMenu()}onBrightnessChanged(){var t,e,n,l,a,r,d,_;if(null==this.__attrHandler.lights)return;if(null==this.__attrHandler.lights.minBrightness||null==this.__attrHandler.lights.lightColor)return;if(this.__controlUnits.length<=0)return;let h;null===(t=this.__roomStatus.getControl(s.__lightIconName))||void 0===t||t.backgroundStyler.setImageColor(i.Light.LightOffColor),null===(n=null===(e=this.__roomStatusSideMenu)||void 0===e?void 0:e.getControl(s.__lightIconName))||void 0===n||n.backgroundStyler.setImageColor(i.Light.LightOffColor);let u=null;for(let t=0;t<this.__controlUnits.length;t++){let e=this.__controlUnits[t];if(e instanceof o.LightControl&&(h=this.__useCurrentValues?e.getAttributes().brightness:null!=e.getAttributes().brightnessFeedback?e.getAttributes().brightnessFeedback:e.getAttributes().brightness,null!=h&&(null==u&&(u=0),null!=h&&("number"==typeof h&&h>this.__attrHandler.lights.minBrightness||"boolean"==typeof h&&!0===h)))){null===(l=this.__roomStatus.getControl(s.__lightIconName))||void 0===l||l.backgroundStyler.setImageColor(this.__attrHandler.lights.lightColor),null===(r=null===(a=this.__roomStatusSideMenu)||void 0===a?void 0:a.getControl(s.__lightIconName))||void 0===r||r.backgroundStyler.setImageColor(this.__attrHandler.lights.lightColor),u++;break}}if(this.__sideMenu){let t=null===(_=null===(d=this.__controlUnitHeader.light)||void 0===d?void 0:d.controls)||void 0===_?void 0:_.getControl(s.__controlUnitHeaderSwitchName);null!=u&&(0===u?null==t||t.setState(!1):null==t||t.setState(!0))}this.__useCurrentValues=!1}onWindowPositionChanged(){var t,e;if(null==this.__attrHandler.windows)return;if(null==this.__attrHandler.windows.closePosition||null==this.__attrHandler.windows.openPosition)return;if(this.__controlUnits.length<=0)return;let n,i=null;for(let t=0;t<this.__controlUnits.length;t++){let e=this.__controlUnits[t];if(e instanceof o.WindowControl&&(n=this.__useCurrentValues?e.getAttributes().position:null!=e.getAttributes().positionFeedback?e.getAttributes().positionFeedback:e.getAttributes().position,null!=n&&(null==i&&(i=0),null!=n&&("number"==typeof n&&n>this.__attrHandler.windows.closePosition||"boolean"==typeof n&&!0===n)))){i++;break}}if(this.__sideMenu){let n=null===(e=null===(t=this.__controlUnitHeader.window)||void 0===t?void 0:t.controls)||void 0===e?void 0:e.getControl(s.__controlUnitHeaderSwitchName);null!=i&&(0===i?null==n||n.setState(!1):null==n||n.setState(!0))}this.__useCurrentValues=!1}onOperationStateChanged(){var t,n,l,a,r,d,_,h,u,c;let m,g,b=i.Sunblind.OperationState.invalid,p=null,v=!1;for(let t=0;t<this.__controlUnits.length;t++)m=this.__controlUnits[t],m instanceof o.SunblindControl?(g=m.getAttributes().operationState,null!=g&&g>b&&(b=g,p=t),g===i.Sunblind.OperationState.manual&&(v=!0)):m instanceof o.LightControl?(g=m.getAttributes().operationState,null!=g&&g>b&&(b=g,p=t),g===i.Light.OperationState.manual&&(v=!0)):m instanceof o.WindowControl&&(g=m.getAttributes().operationState,null!=g&&g>b&&(b=g,p=t),g===i.Window.OperationState.manual&&(v=!0));if(null!=p){let h;m=this.__controlUnits[p],m instanceof o.SunblindControl?h=i.Sunblind.getOperationStateDisplayBackgroundAttributes(m.getAttributes().operationState):m instanceof o.LightControl?h=i.Light.getOperationStateDisplayBackgroundAttributes(m.getAttributes().operationState):m instanceof o.WindowControl&&(h=i.Sunblind.getOperationStateDisplayBackgroundAttributes(m.getAttributes().operationState)),h?(this.__roomStatus.getControl(s.__operationStateIconName)||this.__roomStatus.addControl({type:e.Components.ComponentType.Image,name:s.__operationStateIconName,settings:{cssClass:"fixed-size",hide:this.__attrHandler.showRoomName,order:2}}),this.__sideMenu&&!(null===(l=this.__roomStatusSideMenu)||void 0===l?void 0:l.getControl(s.__operationStateIconName))&&(null===(a=this.__roomStatusSideMenu)||void 0===a||a.addControl({type:e.Components.ComponentType.Image,name:s.__operationStateIconName,settings:{cssClass:"fixed-size",order:2}})),null===(r=this.__roomStatus.getControl(s.__operationStateIconName))||void 0===r||r.backgroundStyler.setAttributes(h),null===(_=null===(d=this.__roomStatusSideMenu)||void 0===d?void 0:d.getControl(s.__operationStateIconName))||void 0===_||_.backgroundStyler.setAttributes(h)):(this.__roomStatus.getControl(s.__operationStateIconName)&&this.__roomStatus.removeControl(s.__operationStateIconName),this.__sideMenu&&(null===(t=this.__roomStatusSideMenu)||void 0===t?void 0:t.getControl(s.__operationStateIconName))&&(null===(n=this.__roomStatusSideMenu)||void 0===n||n.removeControl(s.__operationStateIconName)))}else this.__roomStatus.getControl(s.__operationStateIconName)&&this.__roomStatus.removeControl(s.__operationStateIconName),this.__sideMenu&&(null===(h=this.__roomStatusSideMenu)||void 0===h?void 0:h.getControl(s.__operationStateIconName))&&(null===(u=this.__roomStatusSideMenu)||void 0===u||u.removeControl(s.__operationStateIconName));v?this.__roomStatusSideMenu&&!this.__roomStatusSideMenu.getControl(s.__resetManualOperationStateButtonName)&&this.__roomStatusSideMenu.addControl({type:e.Components.ComponentType.Button,name:s.__resetManualOperationStateButtonName,settings:{background:{image:e.Icons.RoomAutomation.ResetManual.path,imageHeight:70,imageHeightUnit:"%",imageWidth:70,imageWidthUnit:"%"},cssClass:"fixed-size",order:5},callback:()=>{var t,n;for(let o=0;o<this.__controlUnits.length;o++)null!=this.__controlUnits[o].getAttributes().resetManualOperationStateSym&&(null===(t=this.__controlUnits[o].getAttributes().resetManualOperationStateSym)||void 0===t||t.write(!0,t=>this.logger.checkServerResult(e.Logger.Severity.warn,t))),(null===(n=this.__attrHandler.baObject)||void 0===n?void 0:n.checkTemplate(i.Light.BaTemplateDefinition,this.__controlUnits[o].baTemplateHandler.baBaTemplateDescription))&&i.Light.resetManualOperationStateToPlc(this.__attrHandler.baObject),null!=this.__controlUnits[o].baInterfaceHandler.getBaInterfaceSym()&&i.Light.resetManualOperationStateToPlc(this.__controlUnits[o].baInterfaceHandler)}}):this.__roomStatusSideMenu&&this.__roomStatusSideMenu.getControl(s.__resetManualOperationStateButtonName)&&(null===(c=this.__roomStatusSideMenu)||void 0===c||c.removeControl(s.__resetManualOperationStateButtonName))}__addControlUnit(n,i){var s,a,r,d,_,h,u,c,m,g,b,p,v,C,H,S,f,w,y,A,B,I,U,N,O,P;return __awaiter(this,void 0,void 0,(function*(){if(this.__currentlyAddedControlUnits.indexOf(n)>-1)return;this.__currentlyAddedControlUnits.push(n);let D=null,M=!1;try{n.type=yield this.__detectControlUnitType(n)}catch(t){this.logger.log(e.Logger.Severity.warn,t,n)}switch(n.type){case l.sunblind:let t=this.childrenHandler.getChildren().get(this.__id+"-sunblind-control-unit-"+this.__ctrlCnt.sunblind);t||(M=!0,t=new o.SunblindControl(this.__id+"-sunblind-control-unit-"+this.__ctrlCnt.sunblind,this),t.setAttributes({usePosition:null===(s=this.__attrHandler.sunblinds)||void 0===s?void 0:s.usePosition,openPosition:null===(a=this.__attrHandler.sunblinds)||void 0===a?void 0:a.openPosition,closePosition:null===(r=this.__attrHandler.sunblinds)||void 0===r?void 0:r.closePosition,useAngle:null===(d=this.__attrHandler.sunblinds)||void 0===d?void 0:d.useAngle,minAngle:null===(_=this.__attrHandler.sunblinds)||void 0===_?void 0:_.minAngle,maxAngle:null===(h=this.__attrHandler.sunblinds)||void 0===h?void 0:h.maxAngle,angleStep:null===(u=this.__attrHandler.sunblinds)||void 0===u?void 0:u.angleStep}),t.createElement()),D=t,t.baTemplateHandler.setBaTemplateDescription(null===(c=this.__attrHandler.sunblinds)||void 0===c?void 0:c.baBaTemplateDescription),null!=(null===(m=this.__attrHandler.sunblinds)||void 0===m?void 0:m.baInterfaceSymbolNames)&&(t.baInterfaceHandler.baInterfaceSymNames=null===(g=this.__attrHandler.sunblinds)||void 0===g?void 0:g.baInterfaceSymbolNames),this.__ctrlCnt.sunblind++;break;case l.light:let i=this.childrenHandler.getChildren().get(this.__id+"-light-control-unit-"+this.__ctrlCnt.light);i||(M=!0,i=new o.LightControl(this.__id+"-light-control-unit-"+this.__ctrlCnt.light,this),i.setAttributes({minBrightness:null===(b=this.__attrHandler.lights)||void 0===b?void 0:b.minBrightness,maxBrightness:null===(p=this.__attrHandler.lights)||void 0===p?void 0:p.maxBrightness,lightColor:null===(v=this.__attrHandler.lights)||void 0===v?void 0:v.lightColor})),D=i,null!=n.displayMode&&(n.displayMode=Number(n.displayMode)),i.baTemplateHandler.setBaTemplateDescription(null===(C=this.__attrHandler.lights)||void 0===C?void 0:C.baBaTemplateDescription),null!=(null===(H=this.__attrHandler.lights)||void 0===H?void 0:H.baInterfaceSymbolNames)&&(i.baInterfaceHandler.baInterfaceSymNames=null===(S=this.__attrHandler.lights)||void 0===S?void 0:S.baInterfaceSymbolNames),this.__ctrlCnt.light++;break;case l.hc:let T=this.childrenHandler.getChildren().get(this.__id+"-hc-control-unit-"+this.__ctrlCnt.hc);T||(M=!0,T=new o.HeatingCoolingControl(this.__id+"-hc-control-unit-"+this.__ctrlCnt.hc,this),T.setAttributes({tempAdjustRange:null===(f=this.__attrHandler.hcs)||void 0===f?void 0:f.tempAdjustRange,unit:null===(w=this.__attrHandler.hcs)||void 0===w?void 0:w.unit}),T.createElement()),D=T,T.baTemplateHandler.setBaTemplateDescription(null===(y=this.__attrHandler.hcs)||void 0===y?void 0:y.baBaTemplateDescription),null!=(null===(A=this.__attrHandler.hcs)||void 0===A?void 0:A.baInterfaceSymbolNames)&&(T.baInterfaceHandler.baInterfaceSymNames=null===(B=this.__attrHandler.hcs)||void 0===B?void 0:B.baInterfaceSymbolNames),this.__ctrlCnt.hc++;break;case l.window:let j=this.childrenHandler.getChildren().get(this.__id+"-window-control-unit-"+this.__ctrlCnt.window);j||(M=!0,j=new o.WindowControl(this.__id+"-window-control-unit-"+this.__ctrlCnt.window,this),j.setAttributes({closePosition:null===(I=this.__attrHandler.windows)||void 0===I?void 0:I.closePosition,openPosition:null===(U=this.__attrHandler.windows)||void 0===U?void 0:U.openPosition}),j.createElement()),D=j,null!=n.displayMode&&(n.displayMode=Number(n.displayMode)),j.baTemplateHandler.setBaTemplateDescription(null===(N=this.__attrHandler.windows)||void 0===N?void 0:N.baBaTemplateDescription),null!=(null===(O=this.__attrHandler.windows)||void 0===O?void 0:O.baInterfaceSymbolNames)&&(j.baInterfaceHandler.baInterfaceSymNames=null===(P=this.__attrHandler.windows)||void 0===P?void 0:P.baInterfaceSymbolNames),this.__ctrlCnt.window++;break;default:this.logger.log(e.Logger.Severity.warn,"Invalid ControlUnitType",n)}D&&(D.setAttributes(n),null!=n.baInterface&&D.setBaInterface(new t.Symbol(n.baInterface)),D.getElement().css("order",i+1),M&&this.__controlUnits.push(D))}))}__createSideMenu(){this.__sideMenu=$("<div>").addClass("tchmi-ba-room-control-side-menu"),this.__sideMenu.on("mousedown click touchstart",e.EventHandler.stopPropagationHandler),this.__sideControlContainer=$("<div>").addClass("side-control-container last"),this.__headerSideMenu=new e.Components.ControlContainer(this.__id+"-header-side-menu",this);let t={type:e.Components.ComponentType.Button,callback:()=>{this.__toggleMenu()},settings:{background:{image:e.Icons.Standard.Right.path},cssClass:"fixed-size"}},n={type:e.Components.ComponentType.Textblock,name:s.__headlineSideMenuName,settings:{textAttributes:{text:this.__attrHandler.name?this.__attrHandler.name:"",horizontalAlignment:"Center"}}};this.__headerSideMenu.setControlsHorizonzalAlignment("Left"),this.__headerSideMenu.addControls([t,n]),this.__sideControlContainer.append(this.__headerSideMenu.getElement()),this.__processSideMenuHeader(),this.__roomStatusSideMenu=new e.Components.ControlContainer(this.__id+"-room-status-side-menu",this),this.__ctrlCnt.light>0&&this.__roomStatusSideMenu.addControl({type:e.Components.ComponentType.Image,name:s.__lightIconName,settings:{background:{image:e.Icons.RoomAutomation.Lamp2.path,imageHeight:100,imageHeightUnit:"%",imageWidth:100,imageWidthUnit:"%"},cssClass:"fixed-size"}}),this.__sideControlContainer.append(this.__roomStatusSideMenu.getElement()),this.onOperationStateChanged(),this.onBrightnessChanged(),this.__processSwitchOffDelayActive(),this.__processPresence(),this.__sideMenu.append(this.__sideControlContainer),this.__processRoomStatus();let i=!1;for(let t=0;t<this.__controlUnits.length;t++)if(this.__controlUnits[t]instanceof o.LightControl){i||(this.__controlUnitHeader.light||(this.__controlUnitHeader.light=this.__createControlUnitHeader(l.light)),this.__sideMenu.append(this.__controlUnitHeader.light.healine.getElement()),this.__controlUnitHeader.light.controls&&this.__sideMenu.append(this.__controlUnitHeader.light.controls.getElement()),i=!0);let e=this.__controlUnits[t];e.getSideControl().removeClass("last"),this.__sideMenu.append(e.getSideControl())}this.__sideMenu.children().last().addClass("last"),i=!1;for(let t=0;t<this.__controlUnits.length;t++)if(this.__controlUnits[t]instanceof o.SunblindControl){i||(this.__controlUnitHeader.sunblind||(this.__controlUnitHeader.sunblind=this.__createControlUnitHeader(l.sunblind)),this.__sideMenu.append(this.__controlUnitHeader.sunblind.healine.getElement()),this.__controlUnitHeader.sunblind.controls&&this.__sideMenu.append(this.__controlUnitHeader.sunblind.controls.getElement()),i=!0);let e=this.__controlUnits[t];e.getElement().removeClass("last"),this.__sideMenu.append(e.getSideControl())}this.__sideMenu.children().last().addClass("last"),i=!1;for(let t=0;t<this.__controlUnits.length;t++)if(this.__controlUnits[t]instanceof o.HeatingCoolingControl){i||(this.__controlUnitHeader.hc||(this.__controlUnitHeader.hc=this.__createControlUnitHeader(l.hc)),this.__sideMenu.append(this.__controlUnitHeader.hc.healine.getElement()),i=!0);let e=this.__controlUnits[t];e.getElement().removeClass("last"),this.__sideMenu.append(e.getSideControl())}this.__sideMenu.children().last().addClass("last"),i=!1;for(let t=0;t<this.__controlUnits.length;t++)if(this.__controlUnits[t]instanceof o.WindowControl){i||(this.__controlUnitHeader.window||(this.__controlUnitHeader.window=this.__createControlUnitHeader(l.window)),this.__sideMenu.append(this.__controlUnitHeader.window.healine.getElement()),this.__controlUnitHeader.window.controls&&this.__sideMenu.append(this.__controlUnitHeader.window.controls.getElement()),i=!0);let e=this.__controlUnits[t];e.getSideControl().removeClass("last"),this.__sideMenu.append(e.getSideControl())}this.__sideMenu.children().last().addClass("last");this.busyHandler.checkForBusyChildren(()=>{this.__sideMenu&&e.BusyHandler.detachBusyIndicator(this.__sideMenu)})&&e.BusyHandler.appendBusyIndicator(this.__sideMenu)}__createControlUnitHeader(t){var n,a,r;let d=this.__id+"-"+l[t]+"-header",_=null===(n=this.__controlUnitHeader[l[t]])||void 0===n?void 0:n.headline,h=null===(a=this.__controlUnitHeader[l[t]])||void 0===a?void 0:a.controls;if(!_){switch(this.__controlUnitHeader[l[t]]={},_=this.__createHeadlineContainer(d,t),this.__controlUnitHeader[l[t]].headline=_,t){case l.light:case l.window:if(!h){h=new e.Components.ControlContainer(d+"-controls",this),h.getElement().addClass("control-units-header controls");let n=(t,e)=>{var n,i,o,s;let a=100;switch(t){case l.light:null!=(null===(n=this.__attrHandler.lights)||void 0===n?void 0:n.minBrightness)&&null!=(null===(i=this.__attrHandler.lights)||void 0===i?void 0:i.maxBrightness)&&(a=this.__attrHandler.lights.maxBrightness-this.__attrHandler.lights.minBrightness,this.setAllLights(a*e+this.__attrHandler.lights.minBrightness));break;case l.window:null!=(null===(o=this.__attrHandler.windows)||void 0===o?void 0:o.closePosition)&&null!=(null===(s=this.__attrHandler.windows)||void 0===s?void 0:s.openPosition)&&(a=this.__attrHandler.windows.openPosition-this.__attrHandler.windows.closePosition,this.setAllWindows(a*e+this.__attrHandler.windows.closePosition))}};h.addControls([{type:e.Components.ComponentType.Slider,name:s.__controlUnitHeaderSliderName,settings:{layout:{maxWidth:80,maxHeight:10,minHeight:10},knobAppearance:e.Components.Slider.KnobAppearance.round},callback:e=>{t===l.light?this.setAllLights(e):this.setAllWindows(e)}},{type:e.Components.ComponentType.Button,callback:()=>{n(t,1/4)}},{type:e.Components.ComponentType.Button,callback:()=>{n(t,.5)}},{type:e.Components.ComponentType.Button,callback:()=>{n(t,3/4)}},{type:e.Components.ComponentType.Checkbox,name:s.__controlUnitHeaderSwitchName,settings:{appearance:e.Components.Checkbox.Appearance.toggleSlider,readOnly:!1,layout:{maxHeight:25,minHeight:25,maxWidth:35,minWidth:35}},callback:e=>{t===l.light?this.setAllLights(e):this.setAllWindows(e)}}])}this.onBrightnessChanged();break;case l.sunblind:h||(h=new e.Components.ControlContainer(d+"-controls",this,{cssClass:"control-units-header controls"}),h.addControls([{type:e.Components.ComponentType.Button,name:"position-down-button",settings:{cssClass:"fixed-size",background:{image:e.Icons.Standard.Down.path,imageHeight:80,imageHeightUnit:"%",imageWidth:80,imageWidthUnit:"%"}},callback:()=>{var t,e;this.__controlUnits.forEach(t=>{t instanceof o.SunblindControl&&t.writeCloseToPlc()}),null===(t=null==h?void 0:h.getControl("position-slider"))||void 0===t||t.setValue(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.closePosition)}},{type:e.Components.ComponentType.Slider,name:"position-slider",settings:{layout:{maxWidth:80,maxHeight:19,minHeight:19},knobAppearance:e.Components.Slider.KnobAppearance.rectangle},callback:t=>{this.__controlUnits.forEach(e=>{e instanceof o.SunblindControl&&e.writePosition(t)})},cbOnCreated:t=>{this.__destroyersToCallOnDestroy.push(e.Locale.Localization.watchText(e.Locale.LangKey.Position,n=>{e.Logger.checkServerResult(e.Logger.Severity.warn,n)&&t.textHandler.setText(n.text)}))}},{type:e.Components.ComponentType.Button,name:"position-up-button",settings:{cssClass:"fixed-size",background:{image:e.Icons.Standard.Up.path,imageHeight:80,imageHeightUnit:"%",imageWidth:80,imageWidthUnit:"%"}},callback:()=>{var t,e;this.__controlUnits.forEach(t=>{t instanceof o.SunblindControl&&t.writeOpenToPlc()}),null===(t=null==h?void 0:h.getControl("position-slider"))||void 0===t||t.setValue(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.openPosition)}}]),(null===(r=this.__attrHandler.sunblinds)||void 0===r?void 0:r.useAngle)&&(i.Sunblind.UseButtonsForAngle?h.addControls([{type:e.Components.ComponentType.Button,name:"angle-minus-button",settings:{cssClass:"fixed-size",background:{image:e.Icons.RoomAutomation.SunblindAngleAdjustmentDown.path,imageHeight:80,imageHeightUnit:"%",imageWidth:80,imageWidthUnit:"%"}},callback:()=>{var t,e,n;let i=0;if(this.__controlUnits.forEach(t=>{if(t instanceof o.SunblindControl){if(i=t.getAngle(),null!=i)return;i=0}}),null!=i){let s=i-(null!=(null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.angleStep)?this.__attrHandler.sunblinds.angleStep:5);null!=(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.maxAngle)&&null!=(null===(n=this.__attrHandler.sunblinds)||void 0===n?void 0:n.minAngle)&&(this.__attrHandler.sunblinds.maxAngle>this.__attrHandler.sunblinds.minAngle?s<this.__attrHandler.sunblinds.minAngle&&(s=this.__attrHandler.sunblinds.minAngle):s<this.__attrHandler.sunblinds.maxAngle&&(s=this.__attrHandler.sunblinds.maxAngle)),this.__controlUnits.forEach(t=>{t instanceof o.SunblindControl&&t.writeAngle(s)})}}},{type:e.Components.ComponentType.Button,name:"angle-plus-button",settings:{cssClass:"fixed-size",background:{image:e.Icons.RoomAutomation.SunblindAngleAdjustmentUp.path,imageHeight:80,imageHeightUnit:"%",imageWidth:80,imageWidthUnit:"%"}},callback:()=>{var t,e,n,i;let s=0;if(this.__controlUnits.forEach(t=>{if(t instanceof o.SunblindControl){if(s=t.getAngle(),null!=s)return;s=0}}),null!=s){let l=s+(null!=(null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.angleStep)?null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.angleStep:5);null!=(null===(n=this.__attrHandler.sunblinds)||void 0===n?void 0:n.maxAngle)&&null!=(null===(i=this.__attrHandler.sunblinds)||void 0===i?void 0:i.minAngle)&&(this.__attrHandler.sunblinds.maxAngle>this.__attrHandler.sunblinds.minAngle?l>this.__attrHandler.sunblinds.maxAngle&&(l=this.__attrHandler.sunblinds.maxAngle):l>this.__attrHandler.sunblinds.minAngle&&(l=this.__attrHandler.sunblinds.minAngle)),this.__controlUnits.forEach(t=>{t instanceof o.SunblindControl&&t.writeAngle(l)})}}}]):h.addControl({type:e.Components.ComponentType.Slider,name:"angle-slider",settings:{layout:{maxWidth:80,maxHeight:19,minHeight:19},knobAppearance:e.Components.Slider.KnobAppearance.rectangle},callback:t=>{this.__controlUnits.forEach(e=>{e instanceof o.SunblindControl&&e.writeAngle(t)})},cbOnCreated:t=>{this.__destroyersToCallOnDestroy.push(e.Locale.Localization.watchText(e.Locale.LangKey.Angle,n=>{e.Logger.checkServerResult(e.Logger.Severity.warn,n)&&t.textHandler.setText(n.text)}))}})))}this.__controlUnitHeader[l[t]].controls=h,this.__updateControlUnitHeader(t)}return{healine:_,controls:h}}__createHeadlineContainer(t,n){let i=new e.Components.ControlContainer(t+"-headline",this);i.getElement().addClass("control-units-header headline");let o={type:e.Components.ComponentType.Textblock,cbOnCreated:t=>{let i;switch(n){case l.light:i=e.Locale.LangKey.Lights;break;case l.sunblind:i=e.Locale.LangKey.Shading;break;case l.hc:i=e.Locale.LangKey.AirConditionings;break;case l.window:i=e.Locale.LangKey.Windows;break;default:i=e.Locale.LangKey.invalid}this.__destroyersToCallOnDestroy.push(e.Locale.Localization.watchText(i,n=>{e.Logger.checkServerResult(e.Logger.Severity.warn,n)&&t.textHandler.setText(n.text)}))}};return i.addControl(o).getElement().on("click touchstart",t=>{var e;for(let t=0;t<this.__controlUnits.length;t++)if(this.__controlUnits[t].getAttributes().type===n){this.__controlUnits[t].getSideControl().toggleClass("collapse")}let o=null===(e=this.__controlUnitHeader[l[n]])||void 0===e?void 0:e.controls;(null==i?void 0:i.getElement().hasClass("collapse"))?(null==i||i.getElement().removeClass("collapse"),null==o||o.getElement().removeClass("collapse")):(setTimeout(()=>{null==i||i.getElement().addClass("collapse")},300),null==o||o.getElement().addClass("collapse"))}),i}__updateControlUnitHeader(n){var o,a,r,d,_,h,u,c,m,g,b,p,v,C,H,S;let f=null===(o=this.__controlUnitHeader[l[n]])||void 0===o?void 0:o.controls;if(null!=f)switch(n){case l.light:case l.window:let o=f.getControl(s.__controlUnitHeaderSliderName);if(null==o)throw new Error("Slider not available");o.setMinValue(n===l.light?null===(a=this.__attrHandler.lights)||void 0===a?void 0:a.minBrightness:null===(r=this.__attrHandler.windows)||void 0===r?void 0:r.closePosition),o.setMaxValue(n===l.light?null===(d=this.__attrHandler.lights)||void 0===d?void 0:d.maxBrightness:null===(_=this.__attrHandler.windows)||void 0===_?void 0:_.openPosition);for(let o=1;o<f.getControls().length-1;o++){let s=f.getControls()[o];s.setAttributes({layout:{maxWidth:30}});let a=100;switch(n){case l.light:if((null===(h=this.__attrHandler.lights)||void 0===h?void 0:h.lightColor)&&null!=(null===(u=this.__attrHandler.lights)||void 0===u?void 0:u.minBrightness)&&null!=(null===(c=this.__attrHandler.lights)||void 0===c?void 0:c.maxBrightness)){a=this.__attrHandler.lights.maxBrightness-this.__attrHandler.lights.minBrightness;let t=0;switch(o){case 1:t=a/4+this.__attrHandler.lights.minBrightness;break;case 2:t=a/2+this.__attrHandler.lights.minBrightness;break;case 3:t=3*a/4+this.__attrHandler.lights.minBrightness}s.setAttributes({background:{image:e.Icons.RoomAutomation.Lamp2.path,imageHeight:90,imageHeightUnit:"%",imageWidth:90,imageWidthUnit:"%",imageColor:e.Color.getFadeColor(i.Light.LightOffColor,this.__attrHandler.lights.minBrightness,this.__attrHandler.lights.lightColor,this.__attrHandler.lights.maxBrightness,t)}})}break;case l.window:switch(null!=(null===(m=this.__attrHandler.windows)||void 0===m?void 0:m.closePosition)&&null!=(null===(g=this.__attrHandler.windows)||void 0===g?void 0:g.openPosition)&&(a=this.__attrHandler.windows.openPosition-this.__attrHandler.windows.closePosition),o){case 1:s.getElement().css("--tchmi-ba-window-position",10);break;case 2:s.getElement().css("--tchmi-ba-window-position",20);break;case 3:s.getElement().css("--tchmi-ba-window-position",30)}s.setAttributes({background:{image:t.Controls.getBasePath("TcHmi.BuildingAutomation.Controls.RoomAutomation.Window")+"/Images/RoofDome_small.svg",imageHeight:90,imageHeightUnit:"%",imageWidth:90,imageWidthUnit:"%"}})}}break;case l.sunblind:let w=f.getControl("position-slider");if(null==w)throw new Error("Position slider not available");if(w.setMinValue(null===(b=this.__attrHandler.sunblinds)||void 0===b?void 0:b.closePosition),w.setMaxValue(null===(p=this.__attrHandler.sunblinds)||void 0===p?void 0:p.openPosition),w.setValue(null===(v=this.__attrHandler.sunblinds)||void 0===v?void 0:v.closePosition),(null===(C=this.__attrHandler.sunblinds)||void 0===C?void 0:C.useAngle)&&!i.Sunblind.UseButtonsForAngle){let t=f.getControl("angle-slider");if(null==t)throw new Error(this.logger.log(e.Logger.Severity.error,"Position slider could not be created!"));t.setMinValue(null===(H=this.__attrHandler.sunblinds)||void 0===H?void 0:H.minAngle),t.setMaxValue(null===(S=this.__attrHandler.sunblinds)||void 0===S?void 0:S.maxAngle)}}}__destroySideMenu(){var t,e,n,i,o,s,l,a,r,d,_,h;null===(t=this.__headerSideMenu)||void 0===t||t.destroy(),delete this.__headerSideMenu,null===(e=this.__roomStatusSideMenu)||void 0===e||e.destroy(),delete this.__roomStatusSideMenu,null===(n=this.__sideMenu)||void 0===n||n.detach(),delete this.__sideMenu,this.__sideMenuOpen=!1,null===(i=this.__controlUnitHeader.light)||void 0===i||i.healine.destroy(),null===(s=null===(o=this.__controlUnitHeader.light)||void 0===o?void 0:o.controls)||void 0===s||s.destroy(),null===(l=this.__controlUnitHeader.sunblind)||void 0===l||l.healine.destroy(),null===(r=null===(a=this.__controlUnitHeader.sunblind)||void 0===a?void 0:a.controls)||void 0===r||r.destroy(),null===(d=this.__controlUnitHeader.hc)||void 0===d||d.healine.destroy(),null===(h=null===(_=this.__controlUnitHeader.hc)||void 0===_?void 0:_.controls)||void 0===h||h.destroy(),$(window).off("pointerdown",this.__windowPressedHandler)}__toggleMenu(){this.__sideMenuOpen?(this.__sideMenu&&this.__sideMenu.animate({width:"0"},200,()=>{this.__sideMenu&&!this.__sideMenuOpen&&this.__sideMenu.detach(),this.eventHandler.raise(s.ControlEvents.onSideMenuClosed)}),this.__sideMenuOpen=!1,$(window).off("pointerdown",this.__windowPressedHandler)):(this.__sideMenu||this.__createSideMenu(),$("body").append(this.__sideMenu),this.__sideMenu.animate({width:"300px"},200,()=>{this.__sideMenuOpen&&($(window).on("pointerdown",this.__windowPressedHandler),this.eventHandler.raise(s.ControlEvents.onSideMenuOpened))}),this.__sideMenuOpen=!0)}__detectControlUnitType(n){return __awaiter(this,void 0,void 0,(function*(){const o="No ControlUnitType detected!";return new Promise((s,a)=>__awaiter(this,void 0,void 0,(function*(){if(null!=n.type)return s(n.type);if(null!=n.baObject)e.BaObjectHandler.resolveBaObject(n.baObject).then(t=>{var r,d,_,h,u,c,m,g,b,p,v;return t instanceof e.BA.BaBasicObject?(n.baObject=t,null!=(null===(r=this.__attrHandler.lights)||void 0===r?void 0:r.baBaTemplateDescription)&&n.baObject.checkTemplate(i.Light.BaTemplateDefinition,this.__attrHandler.lights.baBaTemplateDescription)||null!=(null===(d=this.__attrHandler.lights)||void 0===d?void 0:d.baInterfaceSymbolNames)&&n.baObject.checkAddParams(i.Light.BaInterfaceDef,this.__attrHandler.lights.baInterfaceSymbolNames)?s(l.light):null!=(null===(_=this.__attrHandler.sunblinds)||void 0===_?void 0:_.baBaTemplateDescription)&&n.baObject.checkTemplate(i.Sunblind.BaTemplateDefinition,null===(h=this.__attrHandler.sunblinds)||void 0===h?void 0:h.baBaTemplateDescription)||null!=(null===(u=this.__attrHandler.sunblinds)||void 0===u?void 0:u.baInterfaceSymbolNames)&&n.baObject.checkAddParams(i.Sunblind.BaInterfaceDef,this.__attrHandler.sunblinds.baInterfaceSymbolNames)?s(l.sunblind):null!=(null===(c=this.__attrHandler.hcs)||void 0===c?void 0:c.baBaTemplateDescription)&&n.baObject.checkTemplate(i.HeatingCooling.BaTemplateDefinition,null===(m=this.__attrHandler.hcs)||void 0===m?void 0:m.baBaTemplateDescription)||null!=(null===(g=this.__attrHandler.hcs)||void 0===g?void 0:g.baInterfaceSymbolNames)&&n.baObject.checkAddParams(i.HeatingCooling.BaInterfaceDef,this.__attrHandler.hcs.baInterfaceSymbolNames)?s(l.hc):null!=(null===(b=this.__attrHandler.windows)||void 0===b?void 0:b.baBaTemplateDescription)&&n.baObject.checkTemplate(i.Window.BaTemplateDefinition,null===(p=this.__attrHandler.windows)||void 0===p?void 0:p.baBaTemplateDescription)||null!=(null===(v=this.__attrHandler.windows)||void 0===v?void 0:v.baInterfaceSymbolNames)&&n.baObject.checkAddParams(i.Window.BaInterfaceDef,this.__attrHandler.windows.baInterfaceSymbolNames)?s(l.window):s(l.invalid)):a(o)}).catch(t=>a(t));else{if(null==n.baInterface)return void 0!==n.brightness||void 0!==n.brightnessFeedback?s(l.light):void 0!==n.position||void 0!==n.positionFeedback?s(l.sunblind):void 0!==n.currentTemp?s(l.hc):void 0!==n.windowPosition||void 0!==n.windowPositionFeedback?(n.position=n.windowPosition,n.positionFeedback=n.windowPositionFeedback,s(l.window)):a(o);if("string"==typeof n.baInterface){new t.Symbol(n.baInterface).resolveSchema(t=>{var n,o,a,r;if(!this.logger.checkServerResult(e.Logger.Severity.warn,t)||null==t.schema)return s(l.invalid);if(null!=(null===(n=this.__attrHandler.lights)||void 0===n?void 0:n.baInterfaceSymbolNames)){let n=e.BaInterfaceHandler.joinDefAndDesc(i.Light.BaInterfaceDef,this.__attrHandler.lights.baInterfaceSymbolNames);if(e.BaInterfaceHandler.validateSchema(t.schema,n))return s(l.light)}if(null!=(null===(o=this.__attrHandler.sunblinds)||void 0===o?void 0:o.baInterfaceSymbolNames)){let n=e.BaInterfaceHandler.joinDefAndDesc(i.Sunblind.BaInterfaceDef,this.__attrHandler.sunblinds.baInterfaceSymbolNames);if(e.BaInterfaceHandler.validateSchema(t.schema,n))return s(l.sunblind)}if(null!=(null===(a=this.__attrHandler.hcs)||void 0===a?void 0:a.baInterfaceSymbolNames)){let n=e.BaInterfaceHandler.joinDefAndDesc(i.HeatingCooling.BaInterfaceDef,this.__attrHandler.hcs.baInterfaceSymbolNames);if(e.BaInterfaceHandler.validateSchema(t.schema,n))return s(l.hc)}if(null!=(null===(r=this.__attrHandler.windows)||void 0===r?void 0:r.baInterfaceSymbolNames)){let n=e.BaInterfaceHandler.joinDefAndDesc(i.Window.BaInterfaceDef,this.__attrHandler.windows.baInterfaceSymbolNames);if(e.BaInterfaceHandler.validateSchema(t.schema,n))return s(l.window)}})}}})))}))}__processRoomStatus(){var t,e,n,i,o,l;null==this.__attrHandler.presence&&null==this.__attrHandler.switchOffDelayActive&&null==(null===(t=this.__roomStatusSideMenu)||void 0===t?void 0:t.getControl(s.__operationStateIconName))&&null==(null===(e=this.__roomStatusSideMenu)||void 0===e?void 0:e.getControl(s.__lightIconName))?(null===(n=this.__roomStatusSideMenu)||void 0===n||n.hide(),null===(i=this.__headerSideMenu)||void 0===i||i.getElement().addClass("last")):(null===(o=this.__roomStatusSideMenu)||void 0===o||o.show(),null===(l=this.__headerSideMenu)||void 0===l||l.getElement().removeClass("last"))}__processSideMenuHeader(){let t=!1;if(this.__controlUnits.forEach(e=>{e.baObjectHandler.baObject&&(t=!0)}),t&&this.__headerSideMenu&&e.Server.UserManagement.checkAccess(e.BA.Role.eAdvanced)&&null==this.__headerSideMenu.getControl(s.__openBaObjectListButtonName)){let t={type:e.Components.ComponentType.Button,name:s.__openBaObjectListButtonName,callback:()=>{var t;let n={Children:new Map};for(let t=0;t<this.__controlUnits.length;t++){let e=this.__controlUnits[t].baObjectHandler.baObject;e&&n.Children.set(e.InstancePath,e)}let i=new e.Navigation.ProjectNavigationList(this.__id+"-view-list",this,{valueHandler:{autoWrite:!0}});i.setData(n),i.getElement().css({position:"relative",height:"100%",width:"100%"});let o={appearance:{headline:{textAttributes:{text:this.__attrHandler.name?this.__attrHandler.name:""}},content:i.getElement(),modal:!1,layout:{width:1e3},buttons:e.Components.DialogWindow.Buttons.CancelSize},callbacks:{cbClosed:()=>{i.destroy()}},behaviour:{destroyOnClose:!0}};null===(t=e.Components.DialogWindow.createDialogWindow(o))||void 0===t||t.open()},settings:{background:{image:e.Icons.ObjectType.Object.path,imageHeight:80,imageHeightUnit:"%",imageWidth:80,imageWidthUnit:"%"},cssClass:"fixed-size"}};this.__headerSideMenu.addControl(t)}}__processShowControlUnits(){this.__controlUnits.forEach(t=>{t instanceof o.LightControl?this.__attrHandler.showLights?(t.createElement(),0==t.getIsAttached()&&this.__element.append(t.getElement())):t.getElement().detach():t instanceof o.SunblindControl?this.__attrHandler.showSunblinds?(t.createElement(),0==t.getIsAttached()&&this.__element.append(t.getElement())):t.getElement().detach():t instanceof o.HeatingCoolingControl?this.__attrHandler.showAirConditionings?(t.createElement(),0==t.getIsAttached()&&this.__element.append(t.getElement())):t.getElement().detach():t instanceof o.WindowControl&&(this.__attrHandler.showWindows?(t.createElement(),0==t.getIsAttached()&&this.__element.append(t.getElement())):t.getElement().detach())}),this.__updateControlHeight()}__updateControlHeight(){let t=0;this.__attrHandler.hideRoomStatus||(t=1),t+=this.__controlUnits.length;for(let e=0;e<this.__controlUnits.length;e++)(!this.__attrHandler.showLights&&this.__controlUnits[e]instanceof o.LightControl||!this.__attrHandler.showSunblinds&&this.__controlUnits[e]instanceof o.SunblindControl||!this.__attrHandler.showAirConditionings&&this.__controlUnits[e]instanceof o.HeatingCoolingControl||!this.__attrHandler.showWindows&&this.__controlUnits[e]instanceof o.WindowControl)&&t--;this.setHeight(30*t)}processBaObject(){var t,n,o,s,a,r,d,_;if(null==(null===(t=this.__attrHandler.lights)||void 0===t?void 0:t.baBaTemplateDescription)||null==(null===(n=this.__attrHandler.sunblinds)||void 0===n?void 0:n.baBaTemplateDescription)||null==(null===(o=this.__attrHandler.hcs)||void 0===o?void 0:o.baBaTemplateDescription)||null==(null===(s=this.__attrHandler.windows)||void 0===s?void 0:s.baBaTemplateDescription))return;if(null==(null===(a=this.__attrHandler.lights)||void 0===a?void 0:a.baInterfaceSymbolNames)||null==(null===(r=this.__attrHandler.sunblinds)||void 0===r?void 0:r.baInterfaceSymbolNames)||null==(null===(d=this.__attrHandler.hcs)||void 0===d?void 0:d.baInterfaceSymbolNames)||null==(null===(_=this.__attrHandler.windows)||void 0===_?void 0:_.baInterfaceSymbolNames))return;if(null==this.baObjectHandler.baObject||!(this.baObjectHandler.baObject instanceof e.BA.BaView))return;let h=[];this.baObjectHandler.tryWatchChildrenBaVariable(this.baObjectHandler.baObject,e.BA.BaParameterId.eInstDescription,t=>{this.setName(t)});let u=this.busyHandler.setBusy("Getting control units from BaObject."),c=e.BA.BaView.getTemplates(this.baObjectHandler.baObject,i.Light.BaTemplateDefinition,this.__attrHandler.lights.baBaTemplateDescription);c=c.concat(e.BA.BaView.getTemplates(this.baObjectHandler.baObject,i.Light.BaInterfaceDef,this.__attrHandler.lights.baInterfaceSymbolNames));for(let t=0;t<c.length;t++)h.push({type:l.light,baObject:c[t]});let m=e.BA.BaView.getTemplates(this.baObjectHandler.baObject,i.Sunblind.BaTemplateDefinition,this.__attrHandler.sunblinds.baBaTemplateDescription);m=m.concat(e.BA.BaView.getTemplates(this.baObjectHandler.baObject,i.Sunblind.BaInterfaceDef,this.__attrHandler.sunblinds.baInterfaceSymbolNames));for(let t=0;t<m.length;t++)h.push({type:l.sunblind,baObject:m[t]});let g=e.BA.BaView.getTemplates(this.baObjectHandler.baObject,i.HeatingCooling.BaTemplateDefinition,this.__attrHandler.hcs.baBaTemplateDescription);g=g.concat(e.BA.BaView.getTemplates(this.baObjectHandler.baObject,i.HeatingCooling.BaInterfaceDef,this.__attrHandler.hcs.baInterfaceSymbolNames));for(let t=0;t<g.length;t++)h.push({type:l.hc,baObject:g[t]});let b=e.BA.BaView.getTemplates(this.baObjectHandler.baObject,i.Window.BaTemplateDefinition,this.__attrHandler.windows.baBaTemplateDescription);b=b.concat(e.BA.BaView.getTemplates(this.baObjectHandler.baObject,i.Window.BaInterfaceDef,this.__attrHandler.windows.baInterfaceSymbolNames));for(let t=0;t<b.length;t++)h.push({type:l.window,baObject:b[t]});this.setControlUnits(h),u()}setAllLights(t){let e;for(let n=0;n<this.__controlUnits.length;n++)e=this.__controlUnits[n],this.__useCurrentValues=!0,e instanceof o.LightControl&&("boolean"==typeof e.getAttributes().brightness?t?e.writeBrightness(!0):e.writeBrightness(!1):"number"==typeof e.getAttributes().brightness&&("boolean"==typeof t?t?e.writeBrightness(e.getAttributes().maxBrightness):e.writeBrightness(e.getAttributes().minBrightness):e.writeBrightness(t)))}setAllWindows(t){let e;for(let n=0;n<this.__controlUnits.length;n++)e=this.__controlUnits[n],this.__useCurrentValues=!0,e instanceof o.WindowControl&&("boolean"==typeof e.getAttributes().position?t?e.writePosition(!0):e.writePosition(!1):"number"==typeof e.getAttributes().position&&("boolean"==typeof t?t?e.writePosition(e.getAttributes().openPosition):e.writePosition(e.getAttributes().closePosition):e.writePosition(t)))}setAllSunblinds(t,e){let n;for(let i=0;i<this.__controlUnits.length;i++)n=this.__controlUnits[i],n instanceof o.SunblindControl&&(n.writePosition(t),n.writeAngle(e))}setBaObject(t){return this.baObjectHandler.setBaObject(t),this}getBaObject(){return this.baObjectHandler.baObject}setAttributes(t){var e,n,i,o,s,l,a,r,d,_,h,u,c,m,g,b;return super.setAttributes(t),void 0!==t.name&&this.setName(t.name),void 0!==t.controlUnitOptions&&this.setControlUnits(t.controlUnitOptions),void 0!==t.presence&&this.setPresence(t.presence),void 0!==t.switchOffDelayActive&&this.setSwitchOffDelayActive(t.switchOffDelayActive),void 0!==t.hideRoomStatus&&this.setHideRoomStatus(t.hideRoomStatus),void 0!==t.showRoomName&&this.setShowRoomName(t.showRoomName),void 0!==t.showLights&&this.setShowLights(t.showLights),void 0!==(null===(e=t.lights)||void 0===e?void 0:e.minBrightness)&&this.setMinBrightness(t.lights.minBrightness),void 0!==(null===(n=t.lights)||void 0===n?void 0:n.maxBrightness)&&this.setMaxBrightness(t.lights.maxBrightness),void 0!==(null===(i=t.lights)||void 0===i?void 0:i.lightColor)&&this.setLightColor(t.lights.lightColor),void 0!==t.showSunblinds&&this.setShowSunblinds(t.showSunblinds),void 0!==(null===(o=t.sunblinds)||void 0===o?void 0:o.openPosition)&&this.setSunblindOpenPosition(t.sunblinds.openPosition),void 0!==(null===(s=t.sunblinds)||void 0===s?void 0:s.closePosition)&&this.setSunblindClosePosition(t.sunblinds.closePosition),void 0!==(null===(l=t.sunblinds)||void 0===l?void 0:l.useAngle)&&this.setUseAngle(t.sunblinds.useAngle),void 0!==(null===(a=t.sunblinds)||void 0===a?void 0:a.minAngle)&&this.setMinAngle(t.sunblinds.minAngle),void 0!==(null===(r=t.sunblinds)||void 0===r?void 0:r.maxAngle)&&this.setMaxAngle(t.sunblinds.maxAngle),void 0!==(null===(d=t.sunblinds)||void 0===d?void 0:d.angleStep)&&this.setAngleStep(t.sunblinds.angleStep),void 0!==(null===(_=t.sunblinds)||void 0===_?void 0:_.openedColor)&&this.setOpenedColor(t.sunblinds.openedColor),void 0!==(null===(h=t.sunblinds)||void 0===h?void 0:h.closedColor)&&this.setClosedColor(t.sunblinds.closedColor),void 0!==(null===(u=t.sunblinds)||void 0===u?void 0:u.slatColor)&&this.setSlatColor(t.sunblinds.slatColor),void 0!==t.showAirConditionings&&this.setShowAirConditionings(t.showAirConditionings),void 0!==(null===(c=t.hcs)||void 0===c?void 0:c.tempAdjustRange)&&this.setTempAdjustRange(t.hcs.tempAdjustRange),void 0!==(null===(m=t.hcs)||void 0===m?void 0:m.unit)&&this.setUnit(t.hcs.unit),void 0!==t.showWindows&&this.setShowWindows(t.showWindows),void 0!==(null===(g=t.windows)||void 0===g?void 0:g.closePosition)&&this.setWindowClosePosition(t.windows.closePosition),void 0!==(null===(b=t.windows)||void 0===b?void 0:b.openPosition)&&this.setWindowOpenPosition(t.windows.openPosition),this}setName(e){let n=t.ValueConverter.toString(e);return null==n&&(n=this.getAttributeDefaultValueInternal("Name")),n==this.__attrHandler.name||null!=n&&"string"!=typeof n||(this.__attrHandler.name=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Name"}),this.__processName()),this}__processName(){var t,e;this.__headerSideMenu&&(null===(t=this.__headerSideMenu.getControl(s.__headlineSideMenuName))||void 0===t||t.textHandler.setText(this.__attrHandler.name)),null===(e=this.__roomStatus.getControl(s.__nameDisplayName))||void 0===e||e.textHandler.setText(this.__attrHandler.name)}getName(){return this.__attrHandler.name}setControlUnits(e){let n=t.ValueConverter.toObject(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ControlUnits")),tchmi_equal(n,this.__attrHandler.controlUnitOptions)||(this.__attrHandler.controlUnitOptions=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ControlUnits"}),this.__processControlUnits()),this}__processControlUnits(){var t,n,i,o,l,a,r,d;return __awaiter(this,void 0,void 0,(function*(){if(null==(null===(t=this.__attrHandler.lights)||void 0===t?void 0:t.baInterfaceSymbolNames)||null==(null===(n=this.__attrHandler.sunblinds)||void 0===n?void 0:n.baInterfaceSymbolNames)||null==(null===(i=this.__attrHandler.hcs)||void 0===i?void 0:i.baInterfaceSymbolNames)||null==(null===(o=this.__attrHandler.windows)||void 0===o?void 0:o.baInterfaceSymbolNames))return;if(null==(null===(l=this.__attrHandler.lights)||void 0===l?void 0:l.baBaTemplateDescription)||null==(null===(a=this.__attrHandler.sunblinds)||void 0===a?void 0:a.baBaTemplateDescription)||null==(null===(r=this.__attrHandler.hcs)||void 0===r?void 0:r.baBaTemplateDescription)||null==(null===(d=this.__attrHandler.windows)||void 0===d?void 0:d.baBaTemplateDescription))return;let _=e.Helper.Object.clone(this.__ctrlCnt);if(this.__ctrlCnt={sunblind:0,light:0,hc:0,window:0},null==this.__attrHandler.controlUnitOptions){for(let t=0;t<this.__controlUnits.length;t++)this.__controlUnits[t].destroy();this.__controlUnits=[]}else{let t=[];for(let e=0;e<this.__attrHandler.controlUnitOptions.length;e++)t.push(this.__addControlUnit(this.__attrHandler.controlUnitOptions[e],e));yield Promise.all(t),this.__currentlyAddedControlUnits=[],this.__processShowControlUnits();for(let t in this.__ctrlCnt)if(_[t]>this.__ctrlCnt[t])for(let e=_[t]-1;e>=this.__ctrlCnt[t];e--){let n=this.childrenHandler.getChildren().get(this.__id+"-"+t+"-control-unit-"+e);if(n){n.destroy();let i=this.__controlUnits.findIndex(n=>n.getId()===this.__id+"-"+t+"-control-unit-"+e);this.__controlUnits.splice(i,1)}}this.onOperationStateChanged()}tchmi_equal(_,this.__ctrlCnt)||(this.__destroySideMenu(),this.onResized()),this.__ctrlCnt.light>0&&!this.__roomStatus.getControl(s.__lightIconName)&&(this.__roomStatus.addControl({type:e.Components.ComponentType.Image,name:s.__lightIconName,settings:{background:{image:e.Icons.RoomAutomation.Lamp2.path,imageHeight:90,imageHeightUnit:"%",imageWidth:90,imageWidthUnit:"%"},cssClass:"fixed-size",hide:this.__attrHandler.showRoomName,order:1}}),this.onBrightnessChanged()),this.__updateControlHeight(),this.__sideMenu&&this.__processSideMenuHeader()}))}getControlUnits(){return this.__attrHandler.controlUnitOptions}setPresence(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("Presence")),n==this.__attrHandler.presence||null!=n&&"boolean"!=typeof n||(this.__attrHandler.presence=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Presence"}),this.__processPresence()),this}__processPresence(){var t,n,i,o,l,a,r,d,_;null==this.__attrHandler.presence?(this.__roomStatus.getControl(s.__presenceIconName)&&this.__roomStatus.removeControl(s.__presenceIconName),this.__sideMenu&&(null===(t=this.__roomStatusSideMenu)||void 0===t?void 0:t.getControl(s.__presenceIconName))&&(null===(n=this.__roomStatusSideMenu)||void 0===n||n.removeControl(s.__presenceIconName)),this.__presenceLegendIconHandler.hide()):(this.__roomStatus.getControl(s.__presenceIconName)||this.__roomStatus.addControl({type:e.Components.ComponentType.Image,name:s.__presenceIconName,settings:{background:{image:e.Icons.RoomAutomation.Presence.path,imageHeight:90,imageHeightUnit:"%",imageWidth:90,imageWidthUnit:"%"},cssClass:"fixed-size",hide:this.__attrHandler.showRoomName,order:3}}),this.__sideMenu&&this.__roomStatusSideMenu&&!this.__roomStatusSideMenu.getControl(s.__presenceIconName)&&(null===(i=this.__roomStatusSideMenu)||void 0===i||i.addControl({type:e.Components.ComponentType.Image,name:s.__presenceIconName,settings:{background:{image:e.Icons.RoomAutomation.Presence.path,imageHeight:100,imageHeightUnit:"%",imageWidth:100,imageWidthUnit:"%"},cssClass:"fixed-size",order:3}})),this.__attrHandler.presence?(null===(o=this.__roomStatus.getControl(s.__presenceIconName))||void 0===o||o.backgroundStyler.setImageColor(e.Color.RGBAColor.DarkOrange),null===(a=null===(l=this.__roomStatusSideMenu)||void 0===l?void 0:l.getControl(s.__presenceIconName))||void 0===a||a.backgroundStyler.setImageColor(e.Color.RGBAColor.DarkOrange)):(null===(r=this.__roomStatus.getControl(s.__presenceIconName))||void 0===r||r.backgroundStyler.setImageColor(e.Color.RGBAColor.White),null===(_=null===(d=this.__roomStatusSideMenu)||void 0===d?void 0:d.getControl(s.__presenceIconName))||void 0===_||_.backgroundStyler.setImageColor(e.Color.RGBAColor.White)),this.__isAttached&&this.__presenceLegendIconHandler.show()),this.__processRoomStatus()}getPresence(){return this.__attrHandler.presence}setSwitchOffDelayActive(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("SwitchOffDelayActive")),n==this.__attrHandler.switchOffDelayActive||null!=n&&"boolean"!=typeof n||(this.__attrHandler.switchOffDelayActive=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SwitchOffDelayActive"}),this.__processSwitchOffDelayActive()),this}__processSwitchOffDelayActive(){var t,n,i,o,l,a,r,d,_;null==this.__attrHandler.switchOffDelayActive?(this.__roomStatus.getControl(s.__switchOffDelayIconName)&&this.__roomStatus.removeControl(s.__switchOffDelayIconName),this.__sideMenu&&(null===(t=this.__roomStatusSideMenu)||void 0===t?void 0:t.getControl(s.__switchOffDelayIconName))&&(null===(n=this.__roomStatusSideMenu)||void 0===n||n.removeControl(s.__switchOffDelayIconName)),this.__switchOffDelayLegendIconHandler.hide()):(this.__roomStatus.getControl(s.__switchOffDelayIconName)||this.__roomStatus.addControl({type:e.Components.ComponentType.Image,name:s.__switchOffDelayIconName,settings:{background:{image:e.Icons.RoomAutomation.SwitchOffDelay.path,imageHeight:90,imageHeightUnit:"%",imageWidth:90,imageWidthUnit:"%"},cssClass:"fixed-size",hide:this.__attrHandler.showRoomName,order:4}}),this.__sideMenu&&this.__roomStatusSideMenu&&!this.__roomStatusSideMenu.getControl(s.__switchOffDelayIconName)&&(null===(i=this.__roomStatusSideMenu)||void 0===i||i.addControl({type:e.Components.ComponentType.Image,name:s.__switchOffDelayIconName,settings:{background:{image:e.Icons.RoomAutomation.SwitchOffDelay.path,imageHeight:100,imageHeightUnit:"%",imageWidth:100,imageWidthUnit:"%"},cssClass:"fixed-size",order:4}})),this.__attrHandler.switchOffDelayActive?(null===(o=this.__roomStatus.getControl(s.__switchOffDelayIconName))||void 0===o||o.backgroundStyler.setImageColor(e.Color.RGBAColor.TcHmiGreen),null===(a=null===(l=this.__roomStatusSideMenu)||void 0===l?void 0:l.getControl(s.__switchOffDelayIconName))||void 0===a||a.backgroundStyler.setImageColor(e.Color.RGBAColor.TcHmiGreen)):(null===(r=this.__roomStatus.getControl(s.__switchOffDelayIconName))||void 0===r||r.backgroundStyler.setImageColor(e.Color.RGBAColor.White),null===(_=null===(d=this.__roomStatusSideMenu)||void 0===d?void 0:d.getControl(s.__switchOffDelayIconName))||void 0===_||_.backgroundStyler.setImageColor(e.Color.RGBAColor.White)),this.__isAttached&&this.__switchOffDelayLegendIconHandler.show()),this.__processRoomStatus()}getSwitchOffDelayActive(){return this.__attrHandler.switchOffDelayActive}setHideRoomStatus(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("HideRoomStatus")),n==this.__attrHandler.hideRoomStatus||null!=n&&"boolean"!=typeof n||(this.__attrHandler.hideRoomStatus=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HideRoomStatus"}),this.__processHideRoomStatus()),this}__processHideRoomStatus(){this.__attrHandler.hideRoomStatus?this.__roomStatus.hide():this.__roomStatus.show(),this.__updateControlHeight(),this.onResized()}getHideRoomStatus(){return this.__attrHandler.hideRoomStatus}setShowRoomName(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ShowRoomName")),n==this.__attrHandler.showRoomName||null!=n&&"boolean"!=typeof n||(this.__attrHandler.showRoomName=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowRoomName"}),this.__processShowRoomName()),this}__processShowRoomName(){var t,n,i,o,l,a,r,d,_,h;this.__attrHandler.showRoomName?(null===(t=this.__roomStatus.getControl(s.__lightIconName))||void 0===t||t.hide(),null===(n=this.__roomStatus.getControl(s.__operationStateIconName))||void 0===n||n.hide(),null===(i=this.__roomStatus.getControl(s.__presenceIconName))||void 0===i||i.hide(),null===(o=this.__roomStatus.getControl(s.__switchOffDelayIconName))||void 0===o||o.hide(),null==this.__roomStatus.getControl(s.__nameDisplayName)&&this.__roomStatus.addControl({type:e.Components.ComponentType.Textblock,name:s.__nameDisplayName,settings:{textAttributes:{horizontalAlignment:"Center",text:this.__attrHandler.name,overflow:e.Components.TextHandler.Overflow.marquee},layout:{width:100,widthUnit:"%"}}}),null===(l=this.__roomStatus.getControl(s.__nameDisplayName))||void 0===l||l.show()):(null===(a=this.__roomStatus.getControl(s.__lightIconName))||void 0===a||a.show(),null===(r=this.__roomStatus.getControl(s.__operationStateIconName))||void 0===r||r.show(),null===(d=this.__roomStatus.getControl(s.__presenceIconName))||void 0===d||d.show(),null===(_=this.__roomStatus.getControl(s.__switchOffDelayIconName))||void 0===_||_.show(),null===(h=this.__roomStatus.getControl(s.__nameDisplayName))||void 0===h||h.hide()),this.__updateControlHeight(),this.onResized()}getShowRoomName(){return this.__attrHandler.showRoomName}setShowLights(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ShowLights")),n==this.__attrHandler.showLights||null!=n&&"boolean"!=typeof n||(this.__attrHandler.showLights=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowLights"}),this.__processShowControlUnits()),this}getShowLights(){return this.__attrHandler.showLights}setMinBrightness(e){var n;let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("MinBrightness")),i===(null===(n=this.__attrHandler.lights)||void 0===n?void 0:n.minBrightness)||(null==this.__attrHandler.lights&&(this.__attrHandler.lights={}),this.__attrHandler.lights.minBrightness=i,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"MinBrightness"}),this.__processMinBrightness()),this}__processMinBrightness(){this.__controlUnits.forEach(t=>{var e;t instanceof o.LightControl&&(t.baObjectHandler.baObject||t.setMinBrightness(null===(e=this.__attrHandler.lights)||void 0===e?void 0:e.minBrightness))}),this.__updateControlUnitHeader(l.light),this.onBrightnessChanged()}getMinBrightness(){var t;return null===(t=this.__attrHandler.lights)||void 0===t?void 0:t.minBrightness}setMaxBrightness(e){var n;let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("MaxBrightness")),i===(null===(n=this.__attrHandler.lights)||void 0===n?void 0:n.maxBrightness)||(null==this.__attrHandler.lights&&(this.__attrHandler.lights={}),this.__attrHandler.lights.maxBrightness=i,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"MaxBrightness"}),this.__processMaxBrightness()),this}__processMaxBrightness(){this.__controlUnits.forEach(t=>{var e;t instanceof o.LightControl&&(t.baObjectHandler.baObject||t.setMaxBrightness(null===(e=this.__attrHandler.lights)||void 0===e?void 0:e.maxBrightness))}),this.__updateControlUnitHeader(l.light),this.onBrightnessChanged()}getMaxBrightness(){var t;return null===(t=this.__attrHandler.lights)||void 0===t?void 0:t.maxBrightness}setLightsBaTemplateDescription(t){return null==t&&(t=this.getAttributeDefaultValueInternal("LightsBaTemplateDescription")),null==this.__attrHandler.lights&&(this.__attrHandler.lights={}),null!=t&&(this.__attrHandler.lights.baBaTemplateDescription=e.BA.BaTemplateHandler.getResultingBaTemplateDescription(t,i.Light.BaTemplateDescription)),null==this.baObjectHandler.baObject?this.__processControlUnits():this.processBaObject(),this}getLightsBaTemplateDescription(){var t;return null===(t=this.__attrHandler.lights)||void 0===t?void 0:t.baBaTemplateDescription}setLightsBaInterfaceSymbolNames(n){var i;let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("LightsBaInterfaceSymbolNames")),o===(null===(i=this.__attrHandler.lights)||void 0===i?void 0:i.baInterfaceSymbolNames)||(null!=o&&(null==this.__attrHandler.lights&&(this.__attrHandler.lights={}),this.__attrHandler.lights.baInterfaceSymbolNames=e.BaInterfaceHandler.convertToBaInterfaceSymbolNames(o)),this.__processLightsBaInterfaceSymbolNames(),this.__processControlUnits()),this}__processLightsBaInterfaceSymbolNames(){var t;null!=(null===(t=this.__attrHandler.lights)||void 0===t?void 0:t.baInterfaceSymbolNames)&&this.__controlUnits.forEach(t=>{t instanceof o.LightControl&&t.setBaInterfaceSymbolNames(this.__attrHandler.lights.baInterfaceSymbolNames)})}getLightsBaInterfaceSymbolNames(){var t;return null===(t=this.__attrHandler.lights)||void 0===t?void 0:t.baInterfaceSymbolNames}setLightColor(n){var i;let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("LightColor")),null!=o&&!e.Color.isSolidColor(o)||void 0===o||o===(null===(i=this.__attrHandler.lights)||void 0===i?void 0:i.lightColor)||(null!=o&&t.isSolidColor(o)&&(o=e.Color.RGBAColor.fromSolidColor(o)),null==o||o instanceof e.Color.RGBAColor||(o=new e.Color.RGBAColor(o)),null==this.__attrHandler.lights&&(this.__attrHandler.lights={}),this.__attrHandler.lights.lightColor=o,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"LightColor"}),this.__processLightColor()),this}__processLightColor(){this.__controlUnits.forEach(t=>{var e;t instanceof o.LightControl&&t.setLightColor(null===(e=this.__attrHandler.lights)||void 0===e?void 0:e.lightColor)}),this.onBrightnessChanged(),this.__updateControlUnitHeader(l.light)}getLightColor(){var t,e;return null===(e=null===(t=this.__attrHandler.lights)||void 0===t?void 0:t.lightColor)||void 0===e?void 0:e.toSolidColor()}setShowSunblinds(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ShowSunblinds")),n==this.__attrHandler.showSunblinds||null!=n&&"boolean"!=typeof n||(this.__attrHandler.showSunblinds=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowSunblinds"}),this.__processShowControlUnits()),this}getShowSunblinds(){return this.__attrHandler.showSunblinds}setUsePosition(e){var n;let i=t.ValueConverter.toBoolean(e);return null==i&&(i=this.getAttributeDefaultValueInternal("UsePosition")),i===(null===(n=this.__attrHandler.sunblinds)||void 0===n?void 0:n.usePosition)||(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.usePosition=i,this.__processUsePosition(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"UsePosition"})),this}__processUsePosition(){this.__controlUnits.forEach(t=>{var e;t instanceof o.SunblindControl&&t.setUsePosition(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.usePosition)})}getUsePosition(){var t;return null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.usePosition}setSunblindOpenPosition(e){var n;let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("SunblindOpenPosition")),i===(null===(n=this.__attrHandler.sunblinds)||void 0===n?void 0:n.openPosition)||(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.openPosition=i,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SunblindOpenPosition"}),this.__processSunblindOpenPosition()),this}__processSunblindOpenPosition(){this.__controlUnits.forEach(t=>{var e;t instanceof o.SunblindControl&&(t.baObjectHandler.baObject||t.setOpenPosition(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.openPosition))}),this.__updateControlUnitHeader(l.sunblind)}getSunblindOpenPosition(){var t;return null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.openPosition}setSunblindClosePosition(e){var n;let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("SunblindClosePosition")),i===(null===(n=this.__attrHandler.sunblinds)||void 0===n?void 0:n.closePosition)||(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.closePosition=i,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SunblindClosePosition"}),this.__processSunblindClosePosition()),this}__processSunblindClosePosition(){this.__controlUnits.forEach(t=>{var e;t instanceof o.SunblindControl&&(t.baObjectHandler.baObject||t.setClosePosition(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.closePosition))}),this.__updateControlUnitHeader(l.sunblind)}getSunblindClosePosition(){var t;return null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.closePosition}setUseAngle(e){var n;let i=t.ValueConverter.toBoolean(e);return null==i&&(i=this.getAttributeDefaultValueInternal("UseAngle")),i===(null===(n=this.__attrHandler.sunblinds)||void 0===n?void 0:n.useAngle)||(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.useAngle=i,this.__processUseAngle(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"UseAngle"})),this}__processUseAngle(){this.__controlUnits.forEach(t=>{var e;t instanceof o.SunblindControl&&t.setUseAngle(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.useAngle)})}getUseAngle(){var t;return null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.useAngle}setMinAngle(e){var n;let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("MinAngle")),i===(null===(n=this.__attrHandler.sunblinds)||void 0===n?void 0:n.minAngle)||(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.minAngle=i,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"MinAngle"}),this.__processMinAngle()),this}__processMinAngle(){this.__controlUnits.forEach(t=>{var e;t instanceof o.SunblindControl&&(t.baObjectHandler.baObject||t.setMinAngle(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.minAngle))}),this.__updateControlUnitHeader(l.sunblind)}getMinAngle(){var t;return null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.minAngle}setMaxAngle(e){var n;let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("MaxAngle")),i===(null===(n=this.__attrHandler.sunblinds)||void 0===n?void 0:n.maxAngle)||(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.maxAngle=i,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"MaxAngle"}),this.__processMaxAngle()),this}__processMaxAngle(){this.__controlUnits.forEach(t=>{var e;t instanceof o.SunblindControl&&(t.baObjectHandler.baObject||t.setMaxAngle(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.maxAngle))}),this.__updateControlUnitHeader(l.sunblind)}getMaxAngle(){var t;return null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.maxAngle}setAngleStep(e){var n;let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("AngleStep")),i===(null===(n=this.__attrHandler.sunblinds)||void 0===n?void 0:n.angleStep)||(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.angleStep=i,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"AngleStep"}),this.__processAngleStep()),this}__processAngleStep(){this.__controlUnits.forEach(t=>{var e;t instanceof o.SunblindControl&&t.setAngleStep(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.angleStep)})}getAngleStep(){var t;return null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.angleStep}setSunblindsBaTemplateDescription(t){return null==t&&(t=this.getAttributeDefaultValueInternal("SunblindsBaTemplateDescription")),null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),null!=t&&(this.__attrHandler.sunblinds.baBaTemplateDescription=e.BA.BaTemplateHandler.getResultingBaTemplateDescription(t,i.Sunblind.BaTemplateDescription)),null==this.baObjectHandler.baObject?this.__processControlUnits():this.processBaObject(),this}getSunblindsBaTemplateDescription(){var t;return null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.baBaTemplateDescription}setSunblindsBaInterfaceSymbolNames(n){var i;let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("SunblindsBaInterfaceSymbolNames")),o===(null===(i=this.__attrHandler.sunblinds)||void 0===i?void 0:i.baInterfaceSymbolNames)||(null!=o&&(null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.baInterfaceSymbolNames=e.BaInterfaceHandler.convertToBaInterfaceSymbolNames(o)),this.__processSunblindssBaInterfaceSymbolNames(),this.__processControlUnits()),this}__processSunblindssBaInterfaceSymbolNames(){var t;null!=(null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.baInterfaceSymbolNames)&&this.__controlUnits.forEach(t=>{t instanceof o.SunblindControl&&t.setBaInterfaceSymbolNames(this.__attrHandler.sunblinds.baInterfaceSymbolNames)})}getSunblindsBaInterfaceSymbolNames(){var t;return null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.baInterfaceSymbolNames}setOpenedColor(n){var i;let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("OpenedColor")),null!=o&&!e.Color.isSolidColor(o)||void 0===o||tchmi_equal(o,null===(i=this.__attrHandler.sunblinds)||void 0===i?void 0:i.openedColor)||(null!=o&&t.isSolidColor(o)&&(o=e.Color.RGBAColor.fromSolidColor(o)),null==o||o instanceof e.Color.RGBAColor||(o=new e.Color.RGBAColor(o)),null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.openedColor=o,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"OpenedColor"}),this.__processOpenedColor()),this}__processOpenedColor(){this.__controlUnits.forEach(t=>{var e;t instanceof o.SunblindControl&&t.setOpenedColor(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.openedColor)})}getOpenedColor(){var t,e;return null===(e=null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.openedColor)||void 0===e?void 0:e.toSolidColor()}setClosedColor(n){var i;let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("ClosedColor")),null!=o&&!e.Color.isSolidColor(o)||void 0===o||tchmi_equal(o,null===(i=this.__attrHandler.sunblinds)||void 0===i?void 0:i.closedColor)||(null!=o&&t.isSolidColor(o)&&(o=e.Color.RGBAColor.fromSolidColor(o)),null==o||o instanceof e.Color.RGBAColor||(o=new e.Color.RGBAColor(o)),null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.closedColor=o,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ClosedColor"}),this.__processClosedColor()),this}__processClosedColor(){this.__controlUnits.forEach(t=>{var e;t instanceof o.SunblindControl&&t.setClosedColor(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.closedColor)})}getClosedColor(){var t,e;return null===(e=null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.closedColor)||void 0===e?void 0:e.toSolidColor()}setSlatColor(n){var i;let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("SlatColor")),null!=o&&!e.Color.isSolidColor(o)||void 0===o||tchmi_equal(o,null===(i=this.__attrHandler.sunblinds)||void 0===i?void 0:i.slatColor)||(null!=o&&t.isSolidColor(o)&&(o=e.Color.RGBAColor.fromSolidColor(o)),null==o||o instanceof e.Color.RGBAColor||(o=new e.Color.RGBAColor(o)),null==this.__attrHandler.sunblinds&&(this.__attrHandler.sunblinds={}),this.__attrHandler.sunblinds.slatColor=o,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SlatColor"}),this.__processSlatColor()),this}__processSlatColor(){this.__controlUnits.forEach(t=>{var e;t instanceof o.SunblindControl&&t.setSlatColor(null===(e=this.__attrHandler.sunblinds)||void 0===e?void 0:e.slatColor)})}getSlatColor(){var t,e;return null===(e=null===(t=this.__attrHandler.sunblinds)||void 0===t?void 0:t.slatColor)||void 0===e?void 0:e.toSolidColor()}setShowAirConditionings(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ShowAirConditionings")),n==this.__attrHandler.showAirConditionings||null!=n&&"boolean"!=typeof n||(this.__attrHandler.showAirConditionings=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowAirConditionings"}),this.__processShowControlUnits()),this}getShowAirConditionings(){return this.__attrHandler.showAirConditionings}setTempAdjustRange(e){var n;let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("TempAdjustRange")),i===(null===(n=this.__attrHandler.hcs)||void 0===n?void 0:n.tempAdjustRange)||(null==i&&(i=3),null==this.__attrHandler.hcs&&(this.__attrHandler.hcs={}),this.__attrHandler.hcs.tempAdjustRange=i,this.__processTempAdjustRange(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"TempAdjustRange"})),this}__processTempAdjustRange(){this.__controlUnits.forEach(t=>{var e;t instanceof o.HeatingCoolingControl&&t.setTempAdjustRange(null===(e=this.__attrHandler.hcs)||void 0===e?void 0:e.tempAdjustRange)})}getTempAdjustRange(){var t;return null===(t=this.__attrHandler.hcs)||void 0===t?void 0:t.tempAdjustRange}setUnit(e){var n;let i=t.ValueConverter.toString(e);return null==i&&(i=this.getAttributeDefaultValueInternal("Unit")),i===(null===(n=this.__attrHandler.hcs)||void 0===n?void 0:n.unit)||(null==this.__attrHandler.hcs&&(this.__attrHandler.hcs={}),this.__attrHandler.hcs.unit=i,this.__processUnit(),t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Unit"})),this}__processUnit(){this.__controlUnits.forEach(t=>{var e;t instanceof o.HeatingCoolingControl&&t.setUnit(null===(e=this.__attrHandler.hcs)||void 0===e?void 0:e.unit)})}getUnit(){var t;return null===(t=this.__attrHandler.hcs)||void 0===t?void 0:t.unit}setHCsBaTemplateDescription(t){return null==t&&(t=this.getAttributeDefaultValueInternal("HCsBaTemplateDescription")),null==this.__attrHandler.hcs&&(this.__attrHandler.hcs={}),null!=t&&(this.__attrHandler.hcs.baBaTemplateDescription=e.BA.BaTemplateHandler.getResultingBaTemplateDescription(t,i.HeatingCooling.BaTemplateDescription)),null==this.baObjectHandler.baObject?this.__processControlUnits():this.processBaObject(),this}getAHCsBaTemplateDescription(){var t;return null===(t=this.__attrHandler.hcs)||void 0===t?void 0:t.baBaTemplateDescription}setHCsBaInterfaceSymbolNames(n){var i;let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("HCsBaInterfaceSymbolNames")),o===(null===(i=this.__attrHandler.hcs)||void 0===i?void 0:i.baInterfaceSymbolNames)||(null!=o&&(null==this.__attrHandler.hcs&&(this.__attrHandler.hcs={}),this.__attrHandler.hcs.baInterfaceSymbolNames=e.BaInterfaceHandler.convertToBaInterfaceSymbolNames(o)),this.__processHCsBaInterfaceSymbolNames(),this.__processControlUnits()),this}__processHCsBaInterfaceSymbolNames(){var t;null!=(null===(t=this.__attrHandler.hcs)||void 0===t?void 0:t.baInterfaceSymbolNames)&&this.__controlUnits.forEach(t=>{t instanceof o.HeatingCoolingControl&&t.setBaInterfaceSymbolNames(this.__attrHandler.hcs.baInterfaceSymbolNames)})}getHCsBaInterfaceSymbolNames(){var t;return null===(t=this.__attrHandler.hcs)||void 0===t?void 0:t.baInterfaceSymbolNames}setShowWindows(e){let n=t.ValueConverter.toBoolean(e);return null==n&&(n=this.getAttributeDefaultValueInternal("ShowWindows")),n==this.__attrHandler.showWindows||null!=n&&"boolean"!=typeof n||(this.__attrHandler.showWindows=n,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowWindows"}),this.__processShowControlUnits()),this}getShowWindows(){return this.__attrHandler.showWindows}setWindowClosePosition(e){var n;let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("WindowClosePosition")),i===(null===(n=this.__attrHandler.windows)||void 0===n?void 0:n.closePosition)||(null==this.__attrHandler.windows&&(this.__attrHandler.windows={}),this.__attrHandler.windows.closePosition=i,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"WindowClosePosition"}),this.__processWindowClosePosition()),this}__processWindowClosePosition(){this.__controlUnits.forEach(t=>{var e;t instanceof o.WindowControl&&(t.baObjectHandler.baObject||t.setClosePosition(null===(e=this.__attrHandler.windows)||void 0===e?void 0:e.closePosition))}),this.__updateControlUnitHeader(l.window)}getWindowClosePosition(){var t;return null===(t=this.__attrHandler.windows)||void 0===t?void 0:t.closePosition}setWindowOpenPosition(e){var n;let i=t.ValueConverter.toNumber(e);return null==i&&(i=this.getAttributeDefaultValueInternal("WindowOpenPosition")),i===(null===(n=this.__attrHandler.windows)||void 0===n?void 0:n.openPosition)||(null==this.__attrHandler.windows&&(this.__attrHandler.windows={}),this.__attrHandler.windows.openPosition=i,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"WindowOpenPosition"}),this.__processWindowOpenPosition()),this}__processWindowOpenPosition(){this.__controlUnits.forEach(t=>{var e;t instanceof o.WindowControl&&(t.baObjectHandler.baObject||t.setOpenPosition(null===(e=this.__attrHandler.windows)||void 0===e?void 0:e.openPosition))}),this.__updateControlUnitHeader(l.window)}getWindowOpenPosition(){var t;return null===(t=this.__attrHandler.windows)||void 0===t?void 0:t.openPosition}setWindowsBaTemplateDescription(t){return null==t&&(t=this.getAttributeDefaultValueInternal("WindowsBaTemplateDescription")),null==this.__attrHandler.windows&&(this.__attrHandler.windows={}),null!=t&&(this.__attrHandler.windows.baBaTemplateDescription=e.BA.BaTemplateHandler.getResultingBaTemplateDescription(t,i.Window.BaTemplateDescription)),null==this.baObjectHandler.baObject?this.__processControlUnits():this.processBaObject(),this}getWindowsBaTemplateDescription(){var t;return null===(t=this.__attrHandler.windows)||void 0===t?void 0:t.baBaTemplateDescription}setWindowsBaInterfaceSymbolNames(n){var i;let o=t.ValueConverter.toObject(n);return null==o&&(o=this.getAttributeDefaultValueInternal("WindowsBaInterfaceSymbolNames")),o===(null===(i=this.__attrHandler.windows)||void 0===i?void 0:i.baInterfaceSymbolNames)||(null!=o&&(null==this.__attrHandler.windows&&(this.__attrHandler.windows={}),this.__attrHandler.windows.baInterfaceSymbolNames=e.BaInterfaceHandler.convertToBaInterfaceSymbolNames(o)),this.__processWindowsBaInterfaceSymbolNames(),this.__processControlUnits()),this}__processWindowsBaInterfaceSymbolNames(){var t;null!=(null===(t=this.__attrHandler.windows)||void 0===t?void 0:t.baInterfaceSymbolNames)&&this.__controlUnits.forEach(t=>{t instanceof o.WindowControl&&t.setBaInterfaceSymbolNames(this.__attrHandler.windows.baInterfaceSymbolNames)})}getWindowsBaInterfaceSymbolNames(){var t;return null===(t=this.__attrHandler.windows)||void 0===t?void 0:t.baInterfaceSymbolNames}}let l;s.__headlineSideMenuName="side-menu-headline",s.__nameDisplayName="name-display",s.__lightIconName="light-icon",s.__operationStateIconName="operation-state-icon",s.__resetManualOperationStateButtonName="reset-manual-operation-state-button",s.__presenceIconName="presence-icon",s.__switchOffDelayIconName="switch-off-delay-icon",s.__openBaObjectListButtonName="open-ba-object-list-button",s.__controlUnitHeaderSwitchName="switch",s.__controlUnitHeaderSliderName="slider",o.Control=s,function(t){let e;!function(t){t.onSideMenuOpened="onSideMenuOpened",t.onSideMenuClosed="onSideMenuClosed"}(e=t.ControlEvents||(t.ControlEvents={}))}(s=o.Control||(o.Control={})),function(t){t[t.invalid=0]="invalid",t[t.light=1]="light",t[t.sunblind=2]="sunblind",t[t.hc=3]="hc",t[t.window=4]="window"}(l=o.ControlUnitType||(o.ControlUnitType={}))}(o=i.RoomControl||(i.RoomControl={}))}(n.RoomAutomation||(n.RoomAutomation={}))}(e.Controls||(e.Controls={}))}(t.BuildingAutomation||(t.BuildingAutomation={}))}(TcHmi||(TcHmi={})),TcHmi.Controls.registerEx("RoomControl","TcHmi.BuildingAutomation.Controls.RoomAutomation",TcHmi.BuildingAutomation.Controls.RoomAutomation.RoomControl.Control);