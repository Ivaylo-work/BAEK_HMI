var TcHmi;!function(e){!function(t){!function(n){!function(n){class o extends n.TextControl{constructor(e,n,o){super(e,n,o),this.__attrHandler=new t.AttrHandler(this),this.__operationStateLegenIconHandler=new t.Components.LegendIconHandler,this.__resetManualModeLegendIconHandler=new t.Components.LegendIconHandler,this.baTemplateHandler=new t.BA.BaTemplateHandler,this.__loadBaChildren=!0,this.__loadTexts=!1,this.__controlContainerElement=$("<div>").addClass("control-container-element"),this.__controlContainers=new Map,this.__hasResetSymbol=!1,this.__transitionendProcessed=!0,this.__bodyPressedHandler=e=>this.__onBodyPressed(e),this.__closeTransitionEndHandler=()=>{0==this.__transitionendProcessed&&(this.__transitionendProcessed=!0,this.__controlContainerElement.detach(),this.__controlContainerElement.off("transitionend",this.__closeTransitionEndHandler))}}__previnit(){null==this.__baFc&&(this.__baFc=new t.Components.Button(this.__id+"-ba-fc",this)),this.baObjectHandler=new t.BaObjectHandler(this),this.__baFc.backgroundStyler.setImageHeight(90,"%").setImageWidth(90,"%"),this.__baFc.getElement().addClass("base-element"),this.__element.append(this.__baFc.getElement()),this.baObjectHandler.loadChildren=this.__loadBaChildren,this.baObjectHandler.loadTexts=this.__loadTexts,this.baTemplateHandler.defaultBaTemplateDescription=this.__defaultBaTemplateDescription,this.baInterfaceHandler=new t.BaInterfaceHandler(this),this.baInterfaceHandler.baInterfaceDefinition=n.BaseRoomControl.BaInterfaceDef,this.setBaInterfaceSymbolNames(n.BaseRoomControl.BaInterfaceSymbolNames),super.__previnit()}__init(){super.__init()}__attach(){super.__attach(),null!=this.__operationStateLegenIconHandler.icon&&this.__operationStateLegenIconHandler.show(),null!=this.__resetManualModeLegendIconHandler.icon&&this.__controlContainerElement.hasClass("open")&&this.__resetManualModeLegendIconHandler.show(),this.__destroyersToCallOnDetach.push(this.__baFc.eventHandler.register(t.Components.Button.ButtonEvents.onPressed,()=>{this.__controlContainerElement.hasClass("open")?this.__closeControlContainer():(this.__openControlContainer(),setTimeout(()=>{$("body").on("click touchstart",this.__bodyPressedHandler)},1))}))}__detach(){super.__detach(),this.__operationStateLegenIconHandler.hide(),this.__resetManualModeLegendIconHandler.hide(),null!=this.__element.children(".control-container-element")[0]&&this.__closeControlContainer()}destroy(){var e;if(!this.__keepAlive){null===(e=this.__operationStateDisplay)||void 0===e||e.destroy();for(let e of this.__controlContainers.values())e.destroy();this.__controlContainers=new Map,super.destroy()}}__onBodyPressed(e){let t=0,n=e.target.parentElement;for(;t<10&&n;){if(n.id===this.__id)return;n=n.parentElement,t++}this.__closeControlContainer(),$("body").off("click touchstart",this.__bodyPressedHandler)}__onResetManualOperationStateButtonPressed(){this.resetManualOperationStateToPlc(),e.EventProvider.raise(this.__id+".onManualOperationStateReset")}__addControl(e,n,o){let a=this.__controlContainers.get(e);return null==a&&(a=new t.Components.ControlContainer(this.__id+"-control-container-"+e),null!=o&&a.getElement().css("order",o),this.__controlContainerElement.append(a.getElement()),this.__controlContainers.set(e,a),this.__updateControlContainerHeight()),a.addControl(n)}__addControls(e,n,o){let a=this.__controlContainers.get(e);return null==a&&(a=new t.Components.ControlContainer(this.__id+"-control-container-"+e),null!=o&&a.getElement().css("order",o),this.__controlContainerElement.append(a.getElement()),this.__controlContainers.set(e,a),this.__updateControlContainerHeight()),a.addControls(n)}__getControl(e,t){var n;return null===(n=this.__controlContainers.get(e))||void 0===n?void 0:n.getControl(t)}__getControls(e){let t=this.__controlContainers.get(e);return null!=t?t.getControls():[]}__removeControl(e,t){let n=this.__controlContainers.get(e);return!(null==n||!n.removeControl(t))&&(n.getControls().length<=0&&(n.destroy(),this.__controlContainers.delete(e),this.__updateControlContainerHeight()),!0)}__removeAllControls(e){let t=this.__controlContainers.get(e);return null!=t&&(t.removeAllControls(),t.destroy(),this.__controlContainers.delete(e),this.__updateControlContainerHeight(),!0)}__updateControlContainerHeight(){this.__element.css("--tchmi-ba-base-control-element-control-container-height",40*this.__controlContainers.size+"px")}__openControlContainer(){this.__element.children(".control-container-element")[0]||this.__controlContainerElement.hasClass("open")||(this.__element.append(this.__controlContainerElement),setTimeout(()=>{this.__controlContainerElement.addClass("open"),this.__oldZIndex=this.getZindex(),this.setZindex(100)},10)),null!=this.__resetManualModeLegendIconHandler.icon&&this.__isAttached&&this.__resetManualModeLegendIconHandler.show()}__closeControlContainer(){this.__controlContainerElement.hasClass("open")&&(this.__controlContainerElement.removeClass("open"),this.__transitionendProcessed=!1,this.__controlContainerElement.on("transitionend",this.__closeTransitionEndHandler),setTimeout(()=>this.__closeTransitionEndHandler(),1e3),void 0!==this.__oldZIndex&&this.setZindex(this.__oldZIndex)),this.__resetManualModeLegendIconHandler.hide()}__appendOperationStateDisplay(e){e?(null==this.__operationStateDisplay&&(this.__operationStateDisplay=new t.Components.Base(this.__id+"-operation-state-display",this),t.Helper.appendSourroundingElements(this.__element,{element:this.__operationStateDisplay.getElement(),position:t.CornerPosition.topRight},{distance:15})),this.__operationStateDisplay.getElement().addClass("corner-element operation-state")):null!=this.__operationStateDisplay&&(this.__operationStateDisplay.destroy(),delete this.__operationStateDisplay)}__appendResetManualOperationStateButton(e){e?(null==this.__getControl(o.__buttonsContainerName,o.__resetManualOperationStateButtonName)&&(this.__addControl(o.__buttonsContainerName,{type:t.Components.ComponentType.Button,name:o.__resetManualOperationStateButtonName,settings:{background:{image:t.Icons.RoomAutomation.ResetManual.path,useSVG:!0,imageHeight:80,imageHeightUnit:"%",imageWidth:80,imageWidthUnit:"%"},cssClass:"corner-element"},callback:()=>this.__onResetManualOperationStateButtonPressed()},10),this.__resetManualModeLegendIconHandler.icon=t.Icons.RoomAutomation.ResetManual),this.__isAttached&&this.__resetManualModeLegendIconHandler.show()):(this.__removeControl(o.__buttonsContainerName,o.__resetManualOperationStateButtonName),this.__resetManualModeLegendIconHandler.hide())}resetManualOperationStateToPlc(){throw new Error("Not implemented!")}processBaObject(){null==this.baObjectHandler.baObject?this.__removeControl(o.__buttonsContainerName,o.__openBaObjectButtonName):t.Server.UserManagement.checkAccess(t.BA.Role.eAdvanced)&&null==this.__getControl(o.__buttonsContainerName,o.__openBaObjectButtonName)&&this.__addControl(o.__buttonsContainerName,{type:t.Components.ComponentType.Button,name:o.__openBaObjectButtonName,settings:{background:{image:t.Icons.ObjectType.Object.path,useSVG:!0,imageHeight:60,imageHeightUnit:"%",imageWidth:60,imageWidthUnit:"%"},cssClass:"corner-element"},callback:()=>{null!=this.baObjectHandler.baObject?this.baObjectHandler.baObject.openNavigationDialog():this.logger.log(t.Logger.Severity.warn,"Navigation dialog could not be opened, because no BaObject is available!")}},10)}setBaInterface(e){return this}getBaInterface(){return this.baInterfaceHandler.getBaInterfaceSym()}setBaInterfaceSymbolNames(e){return null!=e&&(this.baInterfaceHandler.baInterfaceSymNames=t.BaInterfaceHandler.convertToBaInterfaceSymbolNames(e)),this}getBaInterfaceSymbolNames(){return this.baInterfaceHandler.baInterfaceDescription}setBaTemplateDescription(e){return null==e&&(e=this.getAttributeDefaultValueInternal("BaTemplateDescription")),this.baTemplateHandler.setBaTemplateDescription(e),this.processBaObject(),this}getBaTemplateDescription(){return this.baTemplateHandler.getBaTemplateDescription()}__processReadOnly(){super.__processReadOnly(),!0===this.__baFc.getReadOnly()?(this.__closeControlContainer(),this.__baFc.getElement().removeClass("button"),this.__baFc.backgroundStyler.setImageHeight(100,"%").setImageWidth(100,"%")):(this.__baFc.getElement().addClass("button"),this.__baFc.backgroundStyler.setImageHeight(90,"%").setImageWidth(90,"%"))}}o.__resetManualOperationStateButtonName="reset-manual-operation-state-button",o.__openBaObjectButtonName="open-ba-object-button",o.__buttonsContainerName="buttons",n.BaseRoomControl=o,function(e){e.BaInterfaceDef={name:{type:"string",optional:!0}},e.BaInterfaceSymbolNames={name:{symbolName:"sName"}}}(o=n.BaseRoomControl||(n.BaseRoomControl={}))}(n.System||(n.System={}))}(t.Controls||(t.Controls={}))}(e.BuildingAutomation||(e.BuildingAutomation={}))}(TcHmi||(TcHmi={})),TcHmi.Controls.registerEx("BaseRoomControl","TcHmi.BuildingAutomation.Controls.System",TcHmi.BuildingAutomation.Controls.System.BaseRoomControl);